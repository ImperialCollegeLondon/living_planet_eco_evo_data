{"version":2,"kind":"Notebook","sha256":"a6d6757406990a63013dc4b9a8a5fe0825c09ff47a2b6d598f2c6f6106e4d951","slug":"microclimate-sensor-analysis-easylog","location":"/microclimate/microclimate_sensor_analysis_EasyLog.md","dependencies":[],"frontmatter":{"title":"Microclimate sensor data analysis in R","short_title":"Microclimate","authors":[{"nameParsed":{"literal":"Vivienne Groner","given":"Vivienne","family":"Groner"},"name":"Vivienne Groner","id":"contributors-microclimate_sensor_analysis_EasyLog-generated-uid-0"}],"kernelspec":{"name":"ir","display_name":"R","language":"R"},"jupytext":{"formats":"md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.11.5"}},"content_includes_title":false,"exports":[{"format":"md","filename":"microclimate_sensor_analysis_EasyLog.md","url":"https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/microclimate_sensor_-281367e3e1b402e24a831c4023226479.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"This tutorial is designed for ecologists and environmental scientists with basic R\nskills. You will learn how to analyze microclimate data collected with an EasyLog USB\ndatalogger, focusing on loading, cleaning, and exploring, environmental time series\ndata.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"nv6GCdYYwc"}],"key":"ebadq4GieW"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, you will be able to:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"h87Iz7qHO5"}],"key":"gI8ayY1Mca"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Load and combine multiple sensor CSV files and habitat classification data from Excel files","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"B98T66MQ1T"}],"key":"pn6ZgLSlhZ"}],"key":"bnkUBtFcac"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Clean your dataset and check for data quality issues","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"bkFDy7lVFQ"}],"key":"qdRJd4wRnL"}],"key":"EZuTrHqY8p"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Identify and flag potential outliers using different methods","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"WaQ2qEemq3"}],"key":"Q27nFRD8g8"}],"key":"cW9WoJwrX2"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualize microclimate trends over time and across sites","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"QBYqAIvMb3"}],"key":"uV4Dbtb9sW"}],"key":"nlSpeyL2se"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Perform basic statistical summaries","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ZId7rTtTEG"}],"key":"xbBZEmz6ot"}],"key":"nUopPoAWTo"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Fit ANOVA to explore ecological relationships","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"NYCxEgMGLs"}],"key":"Q5gk6R1iWy"}],"key":"tcHLl6Bh1s"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Export cleaned data for further analysis","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"Kdb1pIAJSM"}],"key":"uC08TcyCZm"}],"key":"Li1boUKF6W"}],"key":"lutGxtkQRQ"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"The skills and methods you learn here apply broadly to other environmental\ndatasets.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"tSGsrzQOqi"}],"key":"ZcvEAtEYP4"},{"type":"heading","depth":2,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Load required libraries","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"ggKEGGFL3K"}],"identifier":"load-required-libraries","label":"Load required libraries","html_id":"load-required-libraries","implicit":true,"key":"NthjrZSt9R"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"You will use several R packages that simplify data manipulation, date handling,\nand plotting:","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"NZpe1hAahF"}],"key":"V8u0Q3bMCi"}],"key":"VQPwILznS7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"library(ggplot2)\nlibrary(dplyr)\nlibrary(janitor)     # for cleaning column names and general tidying\nlibrary(patchwork)   # for combining plots","visibility":"show","key":"bEUss5HxBr"},{"type":"output","id":"1Q1UNGFEEFV3ro-PoBhNx","data":[],"visibility":"show","key":"iPZSWTj0SF"}],"data":{"tags":["remove-stderr"]},"visibility":"show","key":"tme9iwtbe0"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Set up file paths","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"LHcMXT9z2R"}],"identifier":"set-up-file-paths","label":"Set up file paths","html_id":"set-up-file-paths","implicit":true,"key":"Jlpdb9rP7c"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"In this practical, we expect to find the sensor data and habitat classification data in\nthe directories described in the ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"OqTMTAaxPJ"},{"type":"link","url":"/practical-requirements","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"practical requirements","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"X67oaDchc2"}],"urlSource":"../practical_requirements.md","dataUrl":"/practical-requirements.json","internal":true,"protocol":"file","key":"wAcql034QL"},{"type":"text","value":"\nnotes.","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"mjytuWAZOy"}],"key":"iKK34lC3Dh"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"More generally, storing file paths in variables makes your code easier to update and\nmaintain. If you move your data later, you only need to change the code in one place.","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"FcS6IGQlYs"}],"key":"p9OQdgbl6d"}],"key":"lZGZzSbSxE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Define the full paths to the folder containing your sensor data and to the \n# metadata file \nsensor_data_folder <- \"../data/Microclimate/2025\"\nsensor_metadata_file <- \"../data/SensorSites/2025/sensor_sites_2025.csv\"\n\n# Get the paths to all of the CSV files containing climate data from this year. This\n# command searches all of the folders within the sensor data folder for *.txt files.\nmicroclimate_files <- dir(\n  path=sensor_data_folder, pattern=\"*.txt\", \n  recursive = TRUE, full.names = TRUE\n)\n\n# Check what files we found\nprint(microclimate_files)","key":"QCidAbmmkt"},{"type":"output","id":"QWCrD135e9ChdRW0C-3rS","data":[{"output_type":"stream","name":"stdout","text":" [1] \"../data/Microclimate/2025/microclimate_DL_06_108_2025/DL-06 (modified).txt\"         \n [2] \"../data/Microclimate/2025/microclimate_DL_14_55_13_2025/DL-14.txt\"                  \n [3] \"../data/Microclimate/2025/microclimate_DL_15_5_63_2025/DL-15.txt\"                   \n [4] \"../data/Microclimate/2025/microclimate_DL_21_16_2025/DL-21 (modified).txt\"          \n [5] \"../data/Microclimate/2025/microclimate_DL_21_16_2025/DL-21.txt\"                     \n [6] \"../data/Microclimate/2025/microclimate_DL_25_97_2025/DL-25_97.txt\"                  \n [7] \"../data/Microclimate/2025/microclimate_DL-11_49_2025/DL-11.txt\"                     \n [8] \"../data/Microclimate/2025/microclimate_DL-12_09_60-2025/DL-12_60_2025.txt\"          \n [9] \"../data/Microclimate/2025/microclimate_DL-18_45_2025/DL-18.txt\"                     \n[10] \"../data/Microclimate/2025/microclimate_DL-20_NHM1_2025/DL-20.txt\"                   \n[11] \"../data/Microclimate/2025/microclimate_DL-26_18_2025/DL-26.txt\"                     \n[12] \"../data/Microclimate/2025/microclimate_DL-27_68_2025/microclimate_DL-27_68_2025.txt\"\n"}],"key":"oDdzZKZxnt"}],"key":"NDvmcYxyFg"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"Read sensor data","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"jYvRhcPQXJ"}],"identifier":"read-sensor-data","label":"Read sensor data","html_id":"read-sensor-data","implicit":true,"key":"V2UDDXbBWV"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Sensor data often contain inconsistencies such as mixed date formats or data types,\nwhich can cause issues during analysis. The format of the output files from the EasyLog\nsensors is also odd - there is the serial number field that only uses the first row.\nHowever, the main data is always in the first five columns. We can use the code below to\ncompile the data across files into a single data frame.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"inRxoMyPLj"}],"key":"ZDmYByQDwO"}],"key":"i0a3EiuyXw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Create an object name to collect combined data\nall_data <- NULL\n\nfor (each_file in microclimate_files) {\n\n    # Load this file, handling Windows file encoding of characters\n    data <- read.csv(each_file, encoding = \"latin1\")\n    \n    # Extract the name of the first column, which is the sensor ID, _except_ that R does\n    # not like hyphens in variable names, so has converted DL-xxx to DL.xxx. So we'll \n    # convert it back.\n    sensor_id <- sub(\".\", \"-\", names(data)[1], fixed=TRUE)\n\n    # Reduce to the first five columns and standardise the field names\n    data <- subset(data, select=1:5)\n    names(data) <- c(\n      \"observation_id\", \"datetime\", \"temperature\", \"humidity\", \"dewpoint\"\n    )\n    \n    # Record the sensor_id\n    data$sensor_id <- sensor_id\n\n    # Add the data on to the combined data\n    all_data <- rbind(all_data, data)\n}\n\n# Convert the time data and sensor id\nall_data$datetime <- as.POSIXct(all_data$datetime)\nall_data$sensor_id <- factor(all_data$sensor_id)","key":"EJ0l0foIPg"},{"type":"output","id":"SSqpm2dDXT8TiNx9CP5dm","data":[],"key":"iTG1jHdV2l"}],"key":"Yp6jDCVUhB"},{"type":"block","children":[{"type":"admonition","kind":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"What just happened?","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"Svr4M71Qhj"}],"key":"zKkktmQx6V"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"It is quite common to want to join a set of identical files into a single data frame.\nThe ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"YmxiZJx6yN"},{"type":"inlineCode","value":"base::rbind","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"uZ8bMHV8Cx"},{"type":"text","value":" function is used to combine two data frames, but how do you get this\nstarted: do you load one file first and then loop the rest? The trick is that\n","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"T9UuPEGhu0"},{"type":"inlineCode","value":"rbind(NULL, my_data_frame)","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"FHuMi3PbPn"},{"type":"text","value":" just gives you back ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"bF13ofAQ3L"},{"type":"inlineCode","value":"my_data_frame","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"TChhuqyByE"},{"type":"text","value":", so we can use it to\nstart the loop over all the files.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"LgFLPR4ZD2"}],"key":"jCG6RtQBxq"}],"key":"Y2LW226ykM"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"We should now be able to preview the data","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"fAhb716aTw"}],"key":"jQnvja4TSX"}],"key":"gkWtsWYi4Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"print(head(all_data))","key":"OwM7ddrUq9"},{"type":"output","id":"96fZkLK-qWLJifNRpA7Kk","data":[{"output_type":"stream","name":"stdout","text":"  observation_id            datetime temperature humidity dewpoint sensor_id\n1              1 2025-10-06 09:00:00        22.5       48     10.9     DL-06\n2              2 2025-10-06 09:15:00        22.5       48     10.9     DL-06\n3              3 2025-10-06 09:30:00        22.5       48     10.9     DL-06\n4              4 2025-10-06 09:45:00        22.5       48     10.9     DL-06\n5              5 2025-10-06 10:00:00        22.5       48     10.9     DL-06\n6              6 2025-10-06 10:15:00        22.5       48     10.9     DL-06\n"}],"key":"VhUQvni5k5"}],"key":"JxIE5uJ3kZ"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"First inspection of the data","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"YEmSHvLqTh"}],"identifier":"first-inspection-of-the-data","label":"First inspection of the data","html_id":"first-inspection-of-the-data","implicit":true,"key":"CCUNozqeCB"},{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Before doing any statistics, ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"w87nkUw0Ca"},{"type":"strong","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"always look at your raw data","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"mL4uuwVsb4"}],"key":"rV13oYSv20"},{"type":"text","value":". An easy way to do this is\na basic boxplot:","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"oQgcIoUasR"}],"key":"EHDgLcNKrQ"}],"key":"gx7QnjauL6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"ggplot(all_data, aes(x = sensor_id, y = temperature)) +\n  geom_boxplot() +\n  labs(\n    title = \"Temperature distribution per sensor\",\n    x = \"Sensor ID\",\n    y = \"Temperature (°C)\"\n  )","key":"M4cIRlb7Rv"},{"type":"output","id":"4jyNbAwR4WuXhFAU30QPF","data":[{"output_type":"display_data","metadata":{"image/png":{"width":420,"height":420}},"data":{"text/plain":{"content":"plot without title","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1f7d9e3e7a6a3955e91bb99bb1e81548","path":"https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/1f7d9e3e7a6a3955e91bb99bb1e81548.png"}}}],"key":"xMXFRv5iZI"}],"key":"I71hkNZ631"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"If you see values far outside the main cluster, they might be outliers or errors.\nHowever, remember: ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"o8m1RJvIGG"},{"type":"strong","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"not all extreme values are mistakes","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"xhKr0Bzws9"}],"key":"TqcfTgM8Yh"},{"type":"text","value":", a sudden heat spike could be\nreal. Always think carefully before you remove any points from your data set.","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"nXULPKBqaP"}],"key":"k5Oi9LINRV"},{"type":"heading","depth":3,"position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"Quick detour: Comparison to station data","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"VMdR2MFSc9"}],"identifier":"quick-detour-comparison-to-station-data","label":"Quick detour: Comparison to station data","html_id":"quick-detour-comparison-to-station-data","implicit":true,"key":"G1n8UnqiwP"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"Go online to explore historic weather data:","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"uRkWIe71mH"}],"key":"ioS4WCkF95"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":157,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://wow.metoffice.gov.uk/","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"UK Met office WOW","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"I33BXvB0Kf"}],"urlSource":"https://wow.metoffice.gov.uk/","key":"ZxgadTCiAU"}],"key":"lObW45Wo0Z"}],"key":"sOGu1NkreR"},{"type":"listItem","spread":true,"position":{"start":{"line":158,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://www.timeanddate.com/weather/@2656992/historic","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"Time and Date historic weather","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"kL7pj3C4ye"}],"urlSource":"https://www.timeanddate.com/weather/@2656992/historic","key":"q6ydnThfKX"}],"key":"gxBfelqJMa"}],"key":"ir3suy2YJg"}],"key":"pIdDhkQYTW"},{"type":"paragraph","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"Look for temperature time series covering your measurement period. Compare:","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"GdsSNXPIyc"}],"key":"Vdore7CW61"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":162,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Are the daily patterns similar?","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"J867m9eiIN"}],"key":"mJlGXA13DZ"}],"key":"wioTRRhOTX"},{"type":"listItem","spread":true,"position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Is the temperature range realistic for the time of year?","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"Iqlgne7nzl"}],"key":"V7jofn1nIS"}],"key":"V834XoHr2b"},{"type":"listItem","spread":true,"position":{"start":{"line":164,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Were any extreme values recorded?","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"HvX8VkJZXM"}],"key":"ylq6LTOOu3"}],"key":"MDUzi6m8gT"}],"key":"nv42Bok5to"},{"type":"paragraph","position":{"start":{"line":166,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"If you find differences between your data and the station observations data,\nwhat could be possible reasons?","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"q3IZNhI4mf"}],"key":"AHZsiy1oJC"},{"type":"heading","depth":2,"position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"Identifying outliers","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"g0cj1OBxCo"}],"identifier":"identifying-outliers","label":"Identifying outliers","html_id":"identifying-outliers","implicit":true,"key":"IRPpgjA4gn"},{"type":"paragraph","position":{"start":{"line":171,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"There are several ways to identify outliers. The table below summarizes three\ncommon methods with their pros and cons.","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"oM1lgwdRWC"}],"key":"bWnc5jKhu0"},{"type":"paragraph","position":{"start":{"line":174,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"You already did the visual inspection;\nZ-score and Interquartile Range (IQR) method are described in more detail below.","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"A05jLoPfBj"}],"key":"bkTgu9zjE8"},{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"Do you expect to get the same outliers with different methods?","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"kRmNAPXBZs"}],"key":"hgI0lFintE"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Sensor specific outliers","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"vCstrOlqSH"}],"key":"bKjcVIHFEx"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"It is appropriate to calculate outliers for each sensor individually\nbecause each sensor can have its own baseline, bias, and range of variation.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ZGWQFoYshP"}],"key":"jUWwwl58GR"}],"key":"IbsoPxcMqN"},{"type":"container","kind":"table","children":[{"type":"table","children":[{"type":"tableRow","children":[{"type":"tableCell","header":true,"children":[{"type":"paragraph","children":[{"type":"text","value":"Method","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"aw1kaZyiin"}],"key":"Vg0rbPI1D8"}],"key":"oyX5kEmzZN"},{"type":"tableCell","header":true,"children":[{"type":"paragraph","children":[{"type":"text","value":"How It Works","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"sTRTD5VB2E"}],"key":"vDRPmsM28P"}],"key":"VGI2cbv7At"},{"type":"tableCell","header":true,"children":[{"type":"paragraph","children":[{"type":"text","value":"Pros","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"CNpQHSAM15"}],"key":"PeWZER8IsF"}],"key":"QKBYGbVX6o"},{"type":"tableCell","header":true,"children":[{"type":"paragraph","children":[{"type":"text","value":"Cons","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"UOtgReXq4f"}],"key":"HfRwouAafJ"}],"key":"MqdPPZbVry"}],"key":"nDBdGuW6X4"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Visual","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"mHHlkN5T6I"}],"key":"xrPjyJPKqq"}],"key":"iEewV98WW8"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Use boxplots or scatterplots to spot unusual points visually.","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"o5iEygIYUl"}],"key":"i2PTZBKUz6"}],"key":"IKANVpQTXm"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Quick, intuitive, and easy to spot obvious anomalies.","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"sNE1yo2Z2N"}],"key":"Tg9byvymDI"}],"key":"pEuq5xv1WB"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Not systematic; subjective; may miss subtle outliers.","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"wGzuAnyyk2"}],"key":"t6lsFUKb7i"}],"key":"BUUCucxSPW"}],"key":"x7FIjSTkKb"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Z-score","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"orqdmt5Gg7"}],"key":"rg6nw1fkTu"}],"key":"jRLt2D4j9U"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Calculate how many standard deviations a value is from the mean.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"rxrhU7ao6r"}],"key":"XxE7Vn6UrG"}],"key":"SfSVqbVvhi"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Fast to compute; effective for bell-shaped (normal) data.","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"h9GKrQ8kpd"}],"key":"f0I2JkDAdJ"}],"key":"EQHUJzgVTk"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Misleading for skewed data or when extreme values distort mean and SD.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"hAER2HRV01"}],"key":"P9ZwfJdsg1"}],"key":"bjgRDr8c52"}],"key":"TNJWa6I4Io"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Inter-quartile range (IQR)","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"lZCR3OOsdo"}],"key":"pMTrbISNTS"}],"key":"GgBh78HNzj"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Flags points outside 1.5×IQR below Q1 or above Q3 percentiles.","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"Q1LUzgGK6U"}],"key":"qpfNZuG93S"}],"key":"NVSzU96H7F"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Robust to skewed data; less influenced by extreme values.","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"K0vU43WNV8"}],"key":"RT78PhPBKn"}],"key":"Prc8812H8O"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"May label valid extreme values as outliers, especially with small sample sizes.","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"uBj7r5CLbK"}],"key":"t4Uk4dbNcp"}],"key":"lJH9pKoiW1"}],"key":"U0AYgEDFOu"}],"key":"SLWelwe91h"}],"enumerator":"1","key":"LkSPrnQ3ae"},{"type":"heading","depth":3,"position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"Z-score method for outlier detection","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"OVIPrqhL2v"}],"identifier":"z-score-method-for-outlier-detection","label":"Z-score method for outlier detection","html_id":"z-score-method-for-outlier-detection","implicit":true,"key":"LvMKbOPcXV"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"The Z-score measures how far each value is from the mean, in units of standard\ndeviations:","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"SXHuEN7N0X"}],"key":"L1FSy1htqZ"},{"type":"math","value":"Z = \\frac{\\text{value} - \\text{mean}}{\\text{standard deviation}}","position":{"start":{"line":213,"column":1},"end":{"line":215,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>Z</mi><mo>=</mo><mfrac><mrow><mtext>value</mtext><mo>−</mo><mtext>mean</mtext></mrow><mtext>standard deviation</mtext></mfrac></mrow><annotation encoding=\"application/x-tex\">Z = \\frac{\\text{value} - \\text{mean}}{\\text{standard deviation}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">standard deviation</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">value</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\">mean</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"gErqKHDlGA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":217,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A Z-score of 0 = exactly the mean.","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"wcz8xu5EJp"}],"key":"a1Uy0dHsrx"}],"key":"iT0Okj33DU"},{"type":"listItem","spread":true,"position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A Z-score of +2 = two standard deviations above the mean.","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"FRGB3zyWI9"}],"key":"OyiWCv19vt"}],"key":"gtoK7RSqOR"},{"type":"listItem","spread":true,"position":{"start":{"line":219,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A Z-score of –3 = three standard deviations below the mean.","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"joQmAVIZtg"}],"key":"PGhIyZFt3m"}],"key":"CeFvG7njVd"}],"key":"KuIEOsAKwz"},{"type":"paragraph","position":{"start":{"line":221,"column":1},"end":{"line":222,"column":1}},"children":[{"type":"text","value":"For normally distributed data, 99.7% of values lie within ±3 standard deviations.\nValues beyond this range are flagged as potential outliers.","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"S9r0u4ZO6j"}],"key":"LHeHbo3tk7"}],"key":"HPPbYOtSM8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"all_data_Z <- all_data %>%\n  # Compute Z-score per sensor_id\n  group_by(sensor_id) %>%\n  mutate(\n    temperature_Z = (\n      (temperature - mean(temperature, na.rm = TRUE))\n      / sd(temperature, na.rm = TRUE)\n    ),\n    temp_outlier_Z = abs(temperature_Z) > 3\n  ) %>%\n  ungroup()\n\n# Check what that added\nprint(head(all_data_Z))","key":"s1isy4ihRr"},{"type":"output","id":"JWH9Y4_OtRtE7g8uLumB1","data":[{"output_type":"stream","name":"stdout","text":"\u001b[90m# A tibble: 6 × 8\u001b[39m\n  observation_id datetime            temperature humidity dewpoint sensor_id\n           \u001b[3m\u001b[90m<int>\u001b[39m\u001b[23m \u001b[3m\u001b[90m<dttm>\u001b[39m\u001b[23m                    \u001b[3m\u001b[90m<dbl>\u001b[39m\u001b[23m    \u001b[3m\u001b[90m<dbl>\u001b[39m\u001b[23m    \u001b[3m\u001b[90m<dbl>\u001b[39m\u001b[23m \u001b[3m\u001b[90m<fct>\u001b[39m\u001b[23m    \n\u001b[90m1\u001b[39m              1 2025-10-06 \u001b[90m09:00:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m2\u001b[39m              2 2025-10-06 \u001b[90m09:15:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m3\u001b[39m              3 2025-10-06 \u001b[90m09:30:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m4\u001b[39m              4 2025-10-06 \u001b[90m09:45:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m5\u001b[39m              5 2025-10-06 \u001b[90m10:00:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m6\u001b[39m              6 2025-10-06 \u001b[90m10:15:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m# ℹ 2 more variables: temperature_Z <dbl>, temp_outlier_Z <lgl>\u001b[39m\n"}],"key":"NCWJbKyF0n"}],"key":"QpsjYQCRKs"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"Interquartile Range (IQR) Method for Outlier Detection","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"n06x4D5Mes"}],"identifier":"interquartile-range-iqr-method-for-outlier-detection","label":"Interquartile Range (IQR) Method for Outlier Detection","html_id":"interquartile-range-iqr-method-for-outlier-detection","implicit":true,"key":"LGSvFF07FT"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"The IQR method focuses on the spread of the middle 50% of the data. It calculates the\ndifference between the 25th percentile (","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"skeU5Kn7H8"},{"type":"inlineMath","value":"Q_1","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">Q_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KY81me47B1"},{"type":"text","value":") and the 75th percentile (","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"aZF4oaCsRW"},{"type":"inlineMath","value":"Q_1","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">Q_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IzksKReRrj"},{"type":"text","value":"), called\nthe interquartile range (IQR). Values falling below ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"Vpeni83ZnC"},{"type":"inlineMath","value":"Q_1 - 1.5 \\times IQR ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mn>1</mn></msub><mo>−</mo><mn>1.5</mn><mo>×</mo><mi>I</mi><mi>Q</mi><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">Q_1 - 1.5 \\times IQR </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1.5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">QR</span></span></span></span>","key":"IAvQigJ6b1"},{"type":"text","value":" or above\n","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"DNVlOMycsO"},{"type":"inlineMath","value":"Q_3 + 1.5 \\times IQR","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mn>3</mn></msub><mo>+</mo><mn>1.5</mn><mo>×</mo><mi>I</mi><mi>Q</mi><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">Q_3 + 1.5 \\times IQR</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1.5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">QR</span></span></span></span>","key":"bYQGt8GyaR"},{"type":"text","value":" are considered potential outliers.","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"YmndVsWlwt"}],"key":"YLwm5QERM0"}],"key":"Rt71ETzJEH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Use the IQR method to flag temperature outliers per sensor\nall_data_IQR <- all_data %>%\n  group_by(sensor_id) %>%\n  mutate(\n    # Temperature IQR\n    temp_Q1 = quantile(temperature, 0.25, na.rm = TRUE),\n    temp_Q3 = quantile(temperature, 0.75, na.rm = TRUE),\n    temp_IQR = temp_Q3 - temp_Q1,\n    temp_outlier_IQR = if_else(\n      temperature < (temp_Q1 - 1.5 * temp_IQR) | temperature > (temp_Q3 + 1.5 * temp_IQR),\n      TRUE, FALSE, missing = FALSE\n    ),\n  ) %>%\n  ungroup()\n\n# Check what that added\nprint(head(all_data_IQR))","key":"PLDxbxq9eg"},{"type":"output","id":"DFX6uqnrp3EgC4QPcGrsj","data":[{"output_type":"stream","name":"stdout","text":"\u001b[90m# A tibble: 6 × 10\u001b[39m\n  observation_id datetime            temperature humidity dewpoint sensor_id\n           \u001b[3m\u001b[90m<int>\u001b[39m\u001b[23m \u001b[3m\u001b[90m<dttm>\u001b[39m\u001b[23m                    \u001b[3m\u001b[90m<dbl>\u001b[39m\u001b[23m    \u001b[3m\u001b[90m<dbl>\u001b[39m\u001b[23m    \u001b[3m\u001b[90m<dbl>\u001b[39m\u001b[23m \u001b[3m\u001b[90m<fct>\u001b[39m\u001b[23m    \n\u001b[90m1\u001b[39m              1 2025-10-06 \u001b[90m09:00:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m2\u001b[39m              2 2025-10-06 \u001b[90m09:15:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m3\u001b[39m              3 2025-10-06 \u001b[90m09:30:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m4\u001b[39m              4 2025-10-06 \u001b[90m09:45:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m5\u001b[39m              5 2025-10-06 \u001b[90m10:00:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m6\u001b[39m              6 2025-10-06 \u001b[90m10:15:00\u001b[39m        22.5       48     10.9 DL-06    \n\u001b[90m# ℹ 4 more variables: temp_Q1 <dbl>, temp_Q3 <dbl>, temp_IQR <dbl>,\u001b[39m\n\u001b[90m#   temp_outlier_IQR <lgl>\u001b[39m\n"}],"key":"vPnEc643vp"}],"key":"g0SFR50BHA"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"Visualize temperature over time with outliers highlighted","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"ArPNHr9pMo"}],"identifier":"visualize-temperature-over-time-with-outliers-highlighted","label":"Visualize temperature over time with outliers highlighted","html_id":"visualize-temperature-over-time-with-outliers-highlighted","implicit":true,"key":"Uj81oKH4zd"}],"key":"ZAG53ZWoAZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"options(repr.plot.width=12, repr.plot.height=10)","visibility":"show","key":"xAUdR73bmB"},{"type":"output","id":"TBLqMA0-v4gtf1hm_95AN","data":[],"visibility":"show","key":"mk4qfG3kjN"}],"data":{"tags":[]},"visibility":"remove","key":"YtNJVVu0qG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Plot using IQR outlier flags\np1 <- ggplot(\n  all_data_IQR,\n  aes(x = datetime, y = temperature, color = temp_outlier_IQR, group = sensor_id)\n) +\n  geom_point() +\n  geom_line() +\n  facet_wrap(~sensor_id) +\n  scale_color_manual(values = c(\"black\", \"red\")) +\n  labs(\n    title = \"Temperature over Time (IQR Outliers)\",\n    x = \"Datetime\",\n    y = \"Temperature (°C)\",\n    color = \"Outlier\"\n  ) +\n  theme_minimal()\n\n# Plot using Z-score outlier flags\np2 <- ggplot(\n  all_data_Z,\n  aes(x = datetime, y = temperature, color = temp_outlier_Z, group = sensor_id)\n) +\n  geom_point() +\n  geom_line() +\n  facet_wrap(~sensor_id) +\n  scale_color_manual(values = c(\"black\", \"blue\")) +\n  labs(\n    title = \"Temperature over Time (Z-score Outliers)\",\n    x = \"Datetime\",\n    y = \"Temperature (°C)\",\n    color = \"Outlier\"\n  ) +\n  theme_minimal()\n\n# Combine plots side-by-side\np1 + p2 + plot_layout(ncol = 1)","key":"a06PuGEm74"},{"type":"output","id":"Nd-vfLviUy1LIMlNplwGo","data":[{"output_type":"display_data","metadata":{"image/png":{"width":720,"height":600}},"data":{"text/plain":{"content":"plot without title","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3ebaa96cf65acc77529f399d3e135bd2","path":"https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/3ebaa96cf65acc77529f399d3e135bd2.png"}}}],"key":"QdSjkbQqjE"}],"key":"W1Sf3KbtY4"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"Read and add sensor location","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"puhVnZMOIP"}],"identifier":"read-and-add-sensor-location","label":"Read and add sensor location","html_id":"read-and-add-sensor-location","implicit":true,"key":"dJBepUMuDm"},{"type":"paragraph","position":{"start":{"line":317,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"text","value":"You will have recorded metadata such as habitat type, location coordinates, or\nnotes about the sensor placement during your field experiment in an Excel\nspreadsheet. The rest of the module will add extra data on the differences between the\nsensor location sites, but for now we can simply look to see if there are any\ndifferences between habitats recorded using Epicollect for the NHM and Silwood sites.","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"sWaGhznJkr"}],"key":"BoZQ3UIVnA"}],"key":"mxydrFlLS5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Read meta data\nmetadata <- read.csv(sensor_metadata_file, as.is=TRUE)\n\n# Get the site location using longitude\nmetadata$site <- ifelse(metadata$long_Sensor_location > -0.5, \"NHM\", \"Silwood\")\n\n# Save the required fields to a smaller data frame\nhabitat_classification <- metadata[,c(\"Logger_SerialNumber\", \"Habitat\", \"site\")]\nnames(habitat_classification) <- c(\"sensor_id\", \"habitat\", \"site\")\n\nhabitat_classification$site <- factor(habitat_classification$site)\nhabitat_classification$habitat <- factor(habitat_classification$habitat)","key":"i2cEaDq74G"},{"type":"output","id":"LeuKr5MIttDnJU0WOiNhY","data":[],"key":"qI6MZVlfXc"}],"key":"BRYAXieysQ"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"Summarize maximum temperature per sensor","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"hZuXRFAZF8"}],"identifier":"summarize-maximum-temperature-per-sensor","label":"Summarize maximum temperature per sensor","html_id":"summarize-maximum-temperature-per-sensor","implicit":true,"key":"taUESqmImh"},{"type":"paragraph","position":{"start":{"line":340,"column":1},"end":{"line":341,"column":1}},"children":[{"type":"text","value":"The following analysis focuses on the IQR data set; try the same\nsteps with the Z-score or other alternative methods in your own time.","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"grlLvs0nLS"}],"key":"Vt0v4EaEs4"}],"key":"FSzbq9Mg9I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Remove outliers and NAs before summarising\nsummary_data <- all_data_IQR %>%\n  filter(!temp_outlier_IQR, !is.na(temperature)) %>%\n  group_by(sensor_id) %>%\n  summarize(max_temperature = max(temperature), .groups = \"drop\") %>%\n  left_join(habitat_classification, by = \"sensor_id\") # add metadata\n\n# Display summary table\nprint(summary_data)","key":"gMJSDzk4Ir"},{"type":"output","id":"Oz-bwVC7hudv2Hkfq7AWw","data":[{"output_type":"stream","name":"stdout","text":"\u001b[90m# A tibble: 11 × 4\u001b[39m\n   sensor_id max_temperature habitat  site   \n   \u001b[3m\u001b[90m<chr>\u001b[39m\u001b[23m               \u001b[3m\u001b[90m<dbl>\u001b[39m\u001b[23m \u001b[3m\u001b[90m<fct>\u001b[39m\u001b[23m    \u001b[3m\u001b[90m<fct>\u001b[39m\u001b[23m  \n\u001b[90m 1\u001b[39m DL-06                18.5 Woodland Silwood\n\u001b[90m 2\u001b[39m DL-11                21   Woodland Silwood\n\u001b[90m 3\u001b[39m DL-12                23   Woodland Silwood\n\u001b[90m 4\u001b[39m DL-14                19.5 Woodland Silwood\n\u001b[90m 5\u001b[39m DL-15                18   Woodland Silwood\n\u001b[90m 6\u001b[39m DL-18                20.5 Woodland Silwood\n\u001b[90m 7\u001b[39m DL-20                20.5 Woodland NHM    \n\u001b[90m 8\u001b[39m DL-21                20   Woodland Silwood\n\u001b[90m 9\u001b[39m DL-25                20.5 Other    Silwood\n\u001b[90m10\u001b[39m DL-26                20   Woodland Silwood\n\u001b[90m11\u001b[39m DL-27                20.5 Woodland Silwood\n"}],"key":"EFXUjeITQn"}],"key":"Kr0TGbL5vw"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"children":[{"type":"text","value":"Fit ANOVA: max temperature ~ location","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"key":"jf533r6ujv"}],"identifier":"fit-anova-max-temperature-location","label":"Fit ANOVA: max temperature ~ location","html_id":"fit-anova-max-temperature-location","implicit":true,"key":"D42Vqm5GNY"},{"type":"paragraph","position":{"start":{"line":357,"column":1},"end":{"line":358,"column":1}},"children":[{"type":"text","value":"ANOVA (Analysis of Variance) is a statistical method used to test whether the\nmeans of a continuous variable differ significantly across two or more groups.","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"pZdT5jL5ml"}],"key":"yRMjRpu8oQ"},{"type":"paragraph","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"children":[{"type":"text","value":"Test whether the max temperature is predicted by location. What do you expect?","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"vQUVRutuFs"}],"key":"dOb6OVI37a"}],"key":"WyYWFjpEpA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Fit ANOVA\nanova_model <- lm(max_temperature ~ habitat, data = summary_data)\nsummary(anova_model) # View ANOVA table","key":"GhFupSYI8X"},{"type":"output","id":"zdKAWeQ0qgfea0yATCwtn","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\nCall:\nlm(formula = max_temperature ~ habitat, data = summary_data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n -2.15  -0.40   0.00   0.35   2.85 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       20.500      1.375  14.905 1.19e-07 ***\nhabitatWoodland   -0.350      1.442  -0.243    0.814    \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 1.375 on 9 degrees of freedom\nMultiple R-squared:  0.006499,\tAdjusted R-squared:  -0.1039 \nF-statistic: 0.05887 on 1 and 9 DF,  p-value: 0.8137\n","content_type":"text/plain"}}}],"key":"XdlHiCZ7Jg"}],"key":"QBVzzLegCj"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"Boxplot maximum temperature - habitat type relationship","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"T15JLyQ2s0"}],"identifier":"boxplot-maximum-temperature-habitat-type-relationship","label":"Boxplot maximum temperature - habitat type relationship","html_id":"boxplot-maximum-temperature-habitat-type-relationship","implicit":true,"key":"HVZrZ7XIDC"}],"key":"qMD3ezJw3W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"ggplot(summary_data, aes(x = habitat, y = max_temperature)) +\n  geom_boxplot(fill = \"lightblue\", alpha = 0.6) +\n  geom_jitter(width = 0.1, size = 2, alpha = 0.7) +\n  labs(\n    title = \"Maximum Temperature by Habitat Type\",\n    x = \"Habitat Type\",\n    y = \"Max Temperature (°C)\"\n  ) +\n  theme_minimal()","key":"RWRF5gM1fr"},{"type":"output","id":"sfYIOFNEVmOfzqnkI-XGh","data":[{"output_type":"display_data","metadata":{"image/png":{"width":720,"height":600}},"data":{"text/plain":{"content":"plot without title","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"407725bc5a4bb67c6f6634ad9bb330e7","path":"https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/407725bc5a4bb67c6f6634ad9bb330e7.png"}}}],"key":"jhtimzdnn8"}],"key":"as0Qm3YQqb"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"children":[{"type":"text","value":"Export new data set","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"key":"oqCYvk3DJs"}],"identifier":"export-new-data-set","label":"Export new data set","html_id":"export-new-data-set","implicit":true,"key":"wud3x572en"},{"type":"paragraph","position":{"start":{"line":384,"column":1},"end":{"line":385,"column":1}},"children":[{"type":"text","value":"This is a good moment to export the combined data set from all sensors, including\ninformation on IQR and outliers.","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"vHKzrobWD3"}],"key":"QKWPiANU4A"}],"key":"bjQ3vmxrfx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"write.csv(all_data_IQR, file.path(sensor_data_folder, \"all_sensor_data_2025.csv\"))","key":"tc8HoZLCAV"},{"type":"output","id":"5XunTfu3XQKU4c_rl4YRj","data":[],"key":"RYxOeLcDyd"}],"key":"mwlqSL0TdD"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"children":[{"type":"text","value":"Optional extensions","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"EqGUK2klDx"}],"identifier":"optional-extensions","label":"Optional extensions","html_id":"optional-extensions","implicit":true,"key":"Sq2ULQIQeH"},{"type":"paragraph","position":{"start":{"line":394,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"Now that you are familiar with the dataset, go explore other variables,\nstatistics, or relationships, for example:","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"D1WtZz7Dk9"}],"key":"yO9zLUYjzb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":397,"column":1},"end":{"line":400,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plotting humidity vs. habitat type","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"xKiaO1aXRT"}],"key":"EBUXVvSabp"}],"key":"osc6LtfRiM"},{"type":"listItem","spread":true,"position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Looking at the diurnal cycle (average daily pattern)","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"Q8IjchvJGz"}],"key":"AOmXPLbzkO"}],"key":"gZXSIkOj17"},{"type":"listItem","spread":true,"position":{"start":{"line":399,"column":1},"end":{"line":400,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comparing spatial variation between sensors","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"HYrtU2G2UV"}],"key":"IwetxzDdxw"}],"key":"MM4blecbOK"}],"key":"mFrqjQiTt4"},{"type":"heading","depth":2,"position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"Reflection Tasks","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"oLJSDw4BHx"}],"identifier":"reflection-tasks","label":"Reflection Tasks","html_id":"reflection-tasks","implicit":true,"key":"uw6gmPrHL9"},{"type":"heading","depth":3,"position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"1. Descriptive statistics paragraph","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"tlKTwJPggI"}],"identifier":"id-1-descriptive-statistics-paragraph","label":"1. Descriptive statistics paragraph","html_id":"id-1-descriptive-statistics-paragraph","implicit":true,"key":"YSsGGG0fZG"},{"type":"paragraph","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"children":[{"type":"text","value":"Write a short summary of:","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"E0aszlTt1x"}],"key":"X8xolY8p0F"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":407,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Your dataset (number of sensors, time range, variables measured)","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"S9ketmkw7Q"}],"key":"yutBaOpOWq"}],"key":"INIV0Yxxbg"},{"type":"listItem","spread":true,"position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Any unusual patterns or outliers","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"key":"S1P38CLU2k"}],"key":"NVfyEf0YTk"}],"key":"pUgFWmhkbm"},{"type":"listItem","spread":true,"position":{"start":{"line":409,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How your measurements compare with official weather station data","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"xcKuW9ClB3"}],"key":"x5RvK6v6xm"}],"key":"bC1vIJGBEf"}],"key":"IEt7jc8vw1"},{"type":"heading","depth":3,"position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"text","value":"2. Interpretation of modelling results","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"key":"TuXbUp0G5p"}],"identifier":"id-2-interpretation-of-modelling-results","label":"2. Interpretation of modelling results","html_id":"id-2-interpretation-of-modelling-results","implicit":true,"key":"tgelygVb78"},{"type":"paragraph","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"text","value":"In ~300 words, explain:","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"aQDQWrALIB"}],"key":"fPKDfGmveW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":415,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"What your ANOVA shows","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"dAMdkIS3m8"}],"key":"QVXVDbBUzF"}],"key":"YBrQIwstLk"},{"type":"listItem","spread":true,"position":{"start":{"line":416,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Whether this result supports your hypothesis","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"mZtlyFyxLj"}],"key":"x42YOA87zw"}],"key":"p2yFP4gl6e"}],"key":"ykUHL71XWj"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Key takeaway","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"qaIMBc8sEK"}],"key":"G0QG1N4byD"},{"type":"paragraph","position":{"start":{"line":420,"column":1},"end":{"line":422,"column":1}},"children":[{"type":"text","value":"Data cleaning and exploratory analysis are not just “pre-work”, they are\nessential steps in understanding your data set, spotting problems, and making\nsure your conclusions are valid.","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"Y7K55mQwtu"}],"key":"gkDz1MNFcs"}],"key":"ICojZtj4el"}],"key":"kMJCEfnRv4"}],"key":"TwHmMAlRz6"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Spatial methods in Ecological and Evolutionary Data Science","short_title":"Spatial Methods","url":"/gis-practical","group":"Ecological and Evolutionary Data Science"}}},"domain":"http://localhost:3000"}