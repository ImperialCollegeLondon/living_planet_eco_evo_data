<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Microclimate sensor data analysis in R - Ecological and Evolutionary Data Science</title><meta property="og:title" content="Microclimate sensor data analysis in R - Ecological and Evolutionary Data Science"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><link rel="stylesheet" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_assets/app-KKSZXL3E.css"/><link rel="stylesheet" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/favicon.ico"/><link rel="stylesheet" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100vw;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="Ecological and Evolutionary Data Science" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/">Ecological and Evolutionary Data Science</a><a title="Required packages and data" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/practical-requirements">Requirements</a><a title="Spatial methods in Ecological and Evolutionary Data Science" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/gis-practical">Spatial Methods</a><a title="Microclimate sensor data analysis in R" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/microclimate-sensor-analysis-easylog">Microclimate</a></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"></div><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Microclimate sensor data analysis in R</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">Vivienne Groner</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><p>This tutorial is designed for ecologists and environmental scientists with basic R
skills. You will learn how to analyze microclimate data collected with an EasyLog USB
datalogger, focusing on loading, cleaning, and exploring, environmental time series
data.</p><p>By the end of this tutorial, you will be able to:</p><ul><li><p>Load and combine multiple sensor CSV files and habitat classification data from Excel files</p></li><li><p>Clean your dataset and check for data quality issues</p></li><li><p>Identify and flag potential outliers using different methods</p></li><li><p>Visualize microclimate trends over time and across sites</p></li><li><p>Perform basic statistical summaries</p></li><li><p>Fit ANOVA to explore ecological relationships</p></li><li><p>Export cleaned data for further analysis</p></li></ul><p>The skills and methods you learn here apply broadly to other environmental
datasets.</p><h2 id="load-required-libraries" class="relative group"><span class="heading-text">Load required libraries</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-required-libraries" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>You will use several R packages that simplify data manipulation, date handling,
and plotting:</p><div id="jFA7DrnrIL" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre">library(openxlsx2)   # for opening excel files
library(ggplot2)
library(dplyr)
# library(tidyverse)   # for data manipulation and plotting
library(janitor)     # for cleaning column names and general tidying
library(patchwork)   # for combining plots</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="XWvgbRRmoAWNqvo2xX9L5" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="set-up-file-paths" class="relative group"><span class="heading-text">Set up file paths</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#set-up-file-paths" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this practical, we expect to find the sensor data and habitat classification data in
the directories described in the <a class="" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/practical-requirements">practical requirements</a>
notes.</p><p>More generally, storing file paths in variables makes your code easier to update and
maintain. If you move your data later, you only need to change the code in one place.</p><div id="VoiOHrxWBo" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre"># Define the full paths to the folder containing your sensor data and to the 
# metadata file 
sensor_data_folder &lt;- &quot;../data/Microclimate/2025&quot;
sensor_metadata_file &lt;- &quot;../data/SensorSites/2025/sensor_sites_2025.csv&quot;

# Get the paths to all of the CSV files containing climate data from this year. This
# command searches all of the folders within the sensor data folder for *.txt files.
microclimate_files &lt;- dir(
  path=sensor_data_folder, pattern=&quot;*.txt&quot;, 
  recursive = TRUE, full.names = TRUE
)

# Check what files we found
print(microclimate_files)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="K3zzhEEnwooViJ-DfAtXh" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span> [1] &quot;../data/Microclimate/2025/microclimate_DL_06_108_2025/DL-06 (modified).txt&quot;         
 [2] &quot;../data/Microclimate/2025/microclimate_DL_14_55_13_2025/DL-14.txt&quot;                  
 [3] &quot;../data/Microclimate/2025/microclimate_DL_15_5_63_2025/DL-15.txt&quot;                   
 [4] &quot;../data/Microclimate/2025/microclimate_DL_21_16_2025/DL-21 (modified).txt&quot;          
 [5] &quot;../data/Microclimate/2025/microclimate_DL_21_16_2025/DL-21.txt&quot;                     
 [6] &quot;../data/Microclimate/2025/microclimate_DL_25_97_2025/DL-25_97.txt&quot;                  
 [7] &quot;../data/Microclimate/2025/microclimate_DL-11_49_2025/DL-11.txt&quot;                     
 [8] &quot;../data/Microclimate/2025/microclimate_DL-12_09_60-2025/DL-12_60_2025.txt&quot;          
 [9] &quot;../data/Microclimate/2025/microclimate_DL-18_45_2025/DL-18.txt&quot;                     
[10] &quot;../data/Microclimate/2025/microclimate_DL-20_NHM1_2025/DL-20.txt&quot;                   
[11] &quot;../data/Microclimate/2025/microclimate_DL-26_18_2025/DL-26.txt&quot;                     
[12] &quot;../data/Microclimate/2025/microclimate_DL-27_68_2025/microclimate_DL-27_68_2025.txt&quot;
</span></code></pre></div></div></div><h2 id="read-sensor-data" class="relative group"><span class="heading-text">Read sensor data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#read-sensor-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Sensor data often contain inconsistencies such as mixed date formats or data types,
which can cause issues during analysis. The format of the output files from the EasyLog
sensors is also odd - there is the serial number field that only uses the first row.
However, the main data is always in the first five columns. We can use the code below to
compile the data across files into a single data frame.</p><div id="ghyjU4Htih" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre"># Create an object name to collect combined data
all_data &lt;- NULL

for (each_file in microclimate_files) {

    # Load this file, handling Windows file encoding of characters
    data &lt;- read.csv(each_file, encoding = &quot;latin1&quot;)
    
    # Extract the name of the first column, which is the sensor ID
    sensor_id &lt;- names(data)[1]

    # Reduce to the first five columns and standardise the field names
    data &lt;- subset(data, select=1:5)
    names(data) &lt;- c(
      &quot;observation_id&quot;, &quot;datetime&quot;, &quot;temperature&quot;, &quot;humidity&quot;, &quot;dewpoint&quot;
    )
    
    # Record the sensor_id
    data$sensor_id &lt;- sensor_id

    # Add the data on to the combined data
    all_data &lt;- rbind(all_data, data)
}

# Convert the time data and sensor id
all_data$datetime &lt;- as.POSIXct(all_data$datetime)
all_data$sensor_id &lt;- factor(all_data$sensor_id)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jBx9tM85pgS9t9KdZVomf" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><aside class="myst-admonition myst-admonition-hint my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">What just happened?</div></div><div class="myst-admonition-body px-4 py-1"><p>It is quite common to want to join a set of identical files into a single data frame.
The <code>base::rbind</code> function is used to combine two data frames, but how do you get this
started: do you load one file first and then loop the rest? The trick is that
<code>rbind(NULL, my_data_frame)</code> just gives you back <code>my_data_frame</code>, so we can use it to
start the loop over all the files.</p></div></aside><p>We should now be able to preview the data</p><div id="fs1VHizpLM" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre">print(head(all_data))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QM1SySfAdtdZF8dBU0NuH" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>  observation_id            datetime temperature humidity dewpoint sensor_id
1              1 2025-10-06 09:00:00        22.5       48     10.9     DL.06
2              2 2025-10-06 09:15:00        22.5       48     10.9     DL.06
3              3 2025-10-06 09:30:00        22.5       48     10.9     DL.06
4              4 2025-10-06 09:45:00        22.5       48     10.9     DL.06
5              5 2025-10-06 10:00:00        22.5       48     10.9     DL.06
6              6 2025-10-06 10:15:00        22.5       48     10.9     DL.06
</span></code></pre></div></div></div><h2 id="first-inspection-of-the-data" class="relative group"><span class="heading-text">First inspection of the data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#first-inspection-of-the-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Before doing any statistics, <strong>always look at your raw data</strong>. An easy way to do this is
a basic boxplot:</p><div id="fTkn46A2b2" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre">ggplot(all_data, aes(x = sensor_id, y = temperature)) +
  geom_boxplot() +
  labs(
    title = &quot;Temperature distribution per sensor&quot;,
    x = &quot;Sensor ID&quot;,
    y = &quot;Temperature (°C)&quot;
  )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4nLukGV_13nsVyo40wll0" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/6e293c0815b8c4a8c15b7a82dc29f3cd.png" alt="plot without title"/></div></div><p>If you see values far outside the main cluster, they might be outliers or errors.
However, remember: <strong>not all extreme values are mistakes</strong>, a sudden heat spike could be
real. Always think carefully before you remove any points from your data set.</p><h3 id="quick-detour-comparison-to-station-data" class="relative group"><span class="heading-text">Quick detour: Comparison to station data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#quick-detour-comparison-to-station-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Go online to explore historic weather data:</p><ul><li><p><a target="_blank" rel="noreferrer" href="https://wow.metoffice.gov.uk/" class="">UK Met office WOW</a></p></li><li><p><a target="_blank" rel="noreferrer" href="https://www.timeanddate.com/weather/@2656992/historic" class="">Time and Date historic weather</a></p></li></ul><p>Look for temperature time series covering your measurement period. Compare:</p><ul><li><p>Are the daily patterns similar?</p></li><li><p>Is the temperature range realistic for the time of year?</p></li><li><p>Were any extreme values recorded?</p></li></ul><p>If you find differences between your data and the station observations data,
what could be possible reasons?</p><h2 id="identifying-outliers" class="relative group"><span class="heading-text">Identifying outliers</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#identifying-outliers" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>There are several ways to identify outliers. The table below summarizes three
common methods with their pros and cons.</p><p>You already did the visual inspection;
Z-score and Interquartile Range (IQR) method are described in more detail below.</p><p>Do you expect to get the same outliers with different methods?</p><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Sensor specific outliers</div></div><div class="myst-admonition-body px-4 py-1"><p>It is appropriate to calculate outliers for each sensor individually
because each sensor can have its own baseline, bias, and range of variation.</p></div></aside><figure id="al6xaGO52J" class="fig-table"><table class=""><tbody><tr class=""><th class=""><p>Method</p></th><th class=""><p>How It Works</p></th><th class=""><p>Pros</p></th><th class=""><p>Cons</p></th></tr><tr class=""><td class=""><p>Visual</p></td><td class=""><p>Use boxplots or scatterplots to spot unusual points visually.</p></td><td class=""><p>Quick, intuitive, and easy to spot obvious anomalies.</p></td><td class=""><p>Not systematic; subjective; may miss subtle outliers.</p></td></tr><tr class=""><td class=""><p>Z-score</p></td><td class=""><p>Calculate how many standard deviations a value is from the mean.</p></td><td class=""><p>Fast to compute; effective for bell-shaped (normal) data.</p></td><td class=""><p>Misleading for skewed data or when extreme values distort mean and SD.</p></td></tr><tr class=""><td class=""><p>Inter-quartile range (IQR)</p></td><td class=""><p>Flags points outside 1.5×IQR below Q1 or above Q3 percentiles.</p></td><td class=""><p>Robust to skewed data; less influenced by extreme values.</p></td><td class=""><p>May label valid extreme values as outliers, especially with small sample sizes.</p></td></tr></tbody></table></figure><h3 id="z-score-method-for-outlier-detection" class="relative group"><span class="heading-text">Z-score method for outlier detection</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#z-score-method-for-outlier-detection" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The Z-score measures how far each value is from the mean, in units of standard
deviations:</p><div id="sgEjXpH5Nu" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Z</mi><mo>=</mo><mfrac><mrow><mtext>value</mtext><mo>−</mo><mtext>mean</mtext></mrow><mtext>standard deviation</mtext></mfrac></mrow><annotation encoding="application/x-tex">Z = \frac{\text{value} - \text{mean}}{\text{standard deviation}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">standard deviation</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">value</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">mean</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#sgEjXpH5Nu" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><ul><li><p>A Z-score of 0 = exactly the mean.</p></li><li><p>A Z-score of +2 = two standard deviations above the mean.</p></li><li><p>A Z-score of –3 = three standard deviations below the mean.</p></li></ul><p>For normally distributed data, 99.7% of values lie within ±3 standard deviations.
Values beyond this range are flagged as potential outliers.</p><div id="UCqYZ4aJhn" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre">all_data_Z &lt;- all_data %&gt;%
  # Compute Z-score per sensor_id
  group_by(sensor_id) %&gt;%
  mutate(
    temperature_Z = (
      (temperature - mean(temperature, na.rm = TRUE))
      / sd(temperature, na.rm = TRUE)
    ),
    temp_outlier_Z = abs(temperature_Z) &gt; 3
  ) %&gt;%
  ungroup()

# Check what that added
print(head(all_data_Z))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qHRuHFJy1-SDjgwarKzdm" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span style="color:rgb(85, 85, 85)"># A tibble: 6 × 8</span><span>
  observation_id datetime            temperature humidity dewpoint sensor_id
           </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;int&gt;</span><span> </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;dttm&gt;</span><span>                    </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;dbl&gt;</span><span>    </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;dbl&gt;</span><span>    </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;dbl&gt;</span><span> </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;fct&gt;</span><span>    
</span><span style="color:rgb(85, 85, 85)">1</span><span>              1 2025-10-06 </span><span style="color:rgb(85, 85, 85)">09:00:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)">2</span><span>              2 2025-10-06 </span><span style="color:rgb(85, 85, 85)">09:15:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)">3</span><span>              3 2025-10-06 </span><span style="color:rgb(85, 85, 85)">09:30:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)">4</span><span>              4 2025-10-06 </span><span style="color:rgb(85, 85, 85)">09:45:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)">5</span><span>              5 2025-10-06 </span><span style="color:rgb(85, 85, 85)">10:00:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)">6</span><span>              6 2025-10-06 </span><span style="color:rgb(85, 85, 85)">10:15:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)"># ℹ 2 more variables: temperature_Z &lt;dbl&gt;, temp_outlier_Z &lt;lgl&gt;</span><span>
</span></code></pre></div></div></div><h3 id="interquartile-range-iqr-method-for-outlier-detection" class="relative group"><span class="heading-text">Interquartile Range (IQR) Method for Outlier Detection</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#interquartile-range-iqr-method-for-outlier-detection" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The IQR method focuses on the spread of the middle 50% of the data.
It calculates the difference between the 75th percentile (Q3) and the
5th percentile (Q1), called the interquartile range (IQR). Values falling below
( Q1 - 1.5 \times IQR ) or above ( Q3 + 1.5 \times IQR ) are considered
potential outliers.</p><div id="HO55apDU2Z" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre"># Use the IQR method to flag temperature outliers per sensor
all_data_IQR &lt;- all_data %&gt;%
  group_by(sensor_id) %&gt;%
  mutate(
    # Temperature IQR
    temp_Q1 = quantile(temperature, 0.25, na.rm = TRUE),
    temp_Q3 = quantile(temperature, 0.75, na.rm = TRUE),
    temp_IQR = temp_Q3 - temp_Q1,
    temp_outlier_IQR = if_else(
      temperature &lt; (temp_Q1 - 1.5 * temp_IQR) | temperature &gt; (temp_Q3 + 1.5 * temp_IQR),
      TRUE, FALSE, missing = FALSE
    ),
  ) %&gt;%
  ungroup()

# Check what that added
print(head(all_data_IQR))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Geh4cJ_X1guMSuKGPeiZM" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span style="color:rgb(85, 85, 85)"># A tibble: 6 × 10</span><span>
  observation_id datetime            temperature humidity dewpoint sensor_id
           </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;int&gt;</span><span> </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;dttm&gt;</span><span>                    </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;dbl&gt;</span><span>    </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;dbl&gt;</span><span>    </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;dbl&gt;</span><span> </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;fct&gt;</span><span>    
</span><span style="color:rgb(85, 85, 85)">1</span><span>              1 2025-10-06 </span><span style="color:rgb(85, 85, 85)">09:00:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)">2</span><span>              2 2025-10-06 </span><span style="color:rgb(85, 85, 85)">09:15:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)">3</span><span>              3 2025-10-06 </span><span style="color:rgb(85, 85, 85)">09:30:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)">4</span><span>              4 2025-10-06 </span><span style="color:rgb(85, 85, 85)">09:45:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)">5</span><span>              5 2025-10-06 </span><span style="color:rgb(85, 85, 85)">10:00:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)">6</span><span>              6 2025-10-06 </span><span style="color:rgb(85, 85, 85)">10:15:00</span><span>        22.5       48     10.9 DL.06    
</span><span style="color:rgb(85, 85, 85)"># ℹ 4 more variables: temp_Q1 &lt;dbl&gt;, temp_Q3 &lt;dbl&gt;, temp_IQR &lt;dbl&gt;,</span><span>
</span><span style="color:rgb(85, 85, 85)">#   temp_outlier_IQR &lt;lgl&gt;</span><span>
</span></code></pre></div></div></div><h2 id="visualize-temperature-over-time-with-outliers-highlighted" class="relative group"><span class="heading-text">Visualize temperature over time with outliers highlighted</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualize-temperature-over-time-with-outliers-highlighted" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="t4JYdYI3MC" class="myst-jp-nb-block relative group/block hidden"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre">options(repr.plot.width=12, repr.plot.height=10)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4C5_y8jFBogiE23zM6WYu" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="QPBvuSa6gt" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre"># Plot using IQR outlier flags
p1 &lt;- ggplot(
  all_data_IQR,
  aes(x = datetime, y = temperature, color = temp_outlier_IQR, group = sensor_id)
) +
  geom_point() +
  geom_line() +
  facet_wrap(~sensor_id) +
  scale_color_manual(values = c(&quot;black&quot;, &quot;red&quot;)) +
  labs(
    title = &quot;Temperature over Time (IQR Outliers)&quot;,
    x = &quot;Datetime&quot;,
    y = &quot;Temperature (°C)&quot;,
    color = &quot;Outlier&quot;
  ) +
  theme_minimal()

# Plot using Z-score outlier flags
p2 &lt;- ggplot(
  all_data_Z,
  aes(x = datetime, y = temperature, color = temp_outlier_Z, group = sensor_id)
) +
  geom_point() +
  geom_line() +
  facet_wrap(~sensor_id) +
  scale_color_manual(values = c(&quot;black&quot;, &quot;blue&quot;)) +
  labs(
    title = &quot;Temperature over Time (Z-score Outliers)&quot;,
    x = &quot;Datetime&quot;,
    y = &quot;Temperature (°C)&quot;,
    color = &quot;Outlier&quot;
  ) +
  theme_minimal()

# Combine plots side-by-side
p1 + p2 + plot_layout(ncol = 1)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3aiTCCk1uZoiHH0Nrs9TE" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/d5863379748047daafa7f9a8dd9534eb.png" alt="plot without title"/></div></div><h2 id="read-and-add-sensor-location" class="relative group"><span class="heading-text">Read and add sensor location</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#read-and-add-sensor-location" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>You will have recorded metadata such as habitat type, location coordinates, or
notes about the sensor placement during your field experiment in an Excel
spreadsheet. The rest of the module will add extra data on the differences between the
sensor location sites, but for now we can simply look to see if there are any
differences between the NHM and Silwood by using the longitude of the locations.</p><div id="wZFHThgtpg" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre"># Read meta data
metadata &lt;- read.csv(sensor_metadata_file)

# Get the site location using longitude
metadata$site &lt;- ifelse(metadata$long_Sensor_location &gt; -0.5, &quot;NHM&quot;, &quot;Silwood&quot;)

# Drop down to two required fields and change Sensor ID from DL-xxx to DL.xxx to match 
# EpiCollect 5 metadata file
habitat_classification &lt;- metadata[,c(&quot;Logger_SerialNumber&quot;, &quot;site&quot;)]
names(habitat_classification) &lt;- c(&quot;sensor_id&quot;, &quot;site&quot;)
habitat_classification$sensor_id &lt;- sub(&quot;-&quot;, &quot;.&quot;, habitat_classification$sensor_id)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="eBvUYGtIIwLHnaA1WWHMq" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="summarize-maximum-temperature-per-sensor" class="relative group"><span class="heading-text">Summarize maximum temperature per sensor</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#summarize-maximum-temperature-per-sensor" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The following analysis focuses on the IQR data set; try the same
steps with the Z-score or other alternative methods in your own time.</p><div id="zzbHP3q5BK" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre"># Remove outliers and NAs before summarising
summary_data &lt;- all_data_IQR %&gt;%
  filter(!temp_outlier_IQR, !is.na(temperature)) %&gt;%
  group_by(sensor_id) %&gt;%
  summarize(max_temperature = max(temperature), .groups = &quot;drop&quot;) %&gt;%
  left_join(habitat_classification, by = &quot;sensor_id&quot;) # add metadata

# Display summary table
print(summary_data)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="iU8Oubruf2bBrMMbquDLC" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span style="color:rgb(85, 85, 85)"># A tibble: 11 × 3</span><span>
   sensor_id max_temperature site   
   </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;chr&gt;</span><span>               </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;dbl&gt;</span><span> </span><span style="color:rgb(85, 85, 85);font-style:italic">&lt;chr&gt;</span><span>  
</span><span style="color:rgb(85, 85, 85)"> 1</span><span> DL.06                18.5 Silwood
</span><span style="color:rgb(85, 85, 85)"> 2</span><span> DL.11                21   Silwood
</span><span style="color:rgb(85, 85, 85)"> 3</span><span> DL.12                23   Silwood
</span><span style="color:rgb(85, 85, 85)"> 4</span><span> DL.14                19.5 Silwood
</span><span style="color:rgb(85, 85, 85)"> 5</span><span> DL.15                18   Silwood
</span><span style="color:rgb(85, 85, 85)"> 6</span><span> DL.18                20.5 Silwood
</span><span style="color:rgb(85, 85, 85)"> 7</span><span> DL.20                20.5 NHM    
</span><span style="color:rgb(85, 85, 85)"> 8</span><span> DL.21                20   Silwood
</span><span style="color:rgb(85, 85, 85)"> 9</span><span> DL.25                20.5 Silwood
</span><span style="color:rgb(85, 85, 85)">10</span><span> DL.26                20   Silwood
</span><span style="color:rgb(85, 85, 85)">11</span><span> DL.27                20.5 </span><span style="color:rgb(187, 0, 0)">NA</span><span>     
</span></code></pre></div></div></div><h2 id="fit-anova-max-temperature-location" class="relative group"><span class="heading-text">Fit ANOVA: max temperature ~ location</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#fit-anova-max-temperature-location" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>ANOVA (Analysis of Variance) is a statistical method used to test whether the
means of a continuous variable differ significantly across two or more groups.</p><p>Test whether the max temperature is predicted by location. What do you expect?</p><div id="PYAbGPcdId" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre"># Fit ANOVA
anova_model &lt;- lm(max_temperature ~ site, data = summary_data)
summary(anova_model) # View ANOVA table</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vgbxPKkhaErkMYzbRLNBa" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="myst-jp-safe-output-text font-mono text-sm whitespace-pre-wrap"><code><span>
Call:
lm(formula = max_temperature ~ site, data = summary_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.11111 -0.48611 -0.05556  0.38889  2.88889 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  20.5000     1.4530  14.109 6.19e-07 ***
siteSilwood  -0.3889     1.5316  -0.254    0.806    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.453 on 8 degrees of freedom
  (1 observation deleted due to missingness)
Multiple R-squared:  0.007995,	Adjusted R-squared:  -0.116 
F-statistic: 0.06447 on 1 and 8 DF,  p-value: 0.806
</span></code></div></div></div><h2 id="boxplot-maximum-temperature-habitat-type-relationship" class="relative group"><span class="heading-text">Boxplot maximum temperature - habitat type relationship</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#boxplot-maximum-temperature-habitat-type-relationship" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="F7d07YLbaT" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre">ggplot(summary_data, aes(x = site, y = max_temperature)) +
  geom_boxplot(fill = &quot;lightblue&quot;, alpha = 0.6) +
  geom_jitter(width = 0.1, size = 2, alpha = 0.7) +
  labs(
    title = &quot;Maximum Temperature by Habitat Type&quot;,
    x = &quot;Habitat Type&quot;,
    y = &quot;Max Temperature (°C)&quot;
  ) +
  theme_minimal()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jTkeJ_OeG8Y9Qtcl6RrLx" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/5b2a88da39983634c7db390b230409a5.png" alt="plot without title"/></div></div><h2 id="export-new-data-set" class="relative group"><span class="heading-text">Export new data set</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#export-new-data-set" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This is a good moment to export the combined data set from all sensors, including
information on IQR and outliers.</p><div id="KkWGjHV4AE" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-r" style="white-space:pre">write.csv(all_data_IQR, file.path(sensor_data_folder, &quot;all_sensor_data_2025.csv&quot;))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="qMG_Kr7f4VJZ1RZ-jZt9K" class="myst-jp-output max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h2 id="optional-extensions" class="relative group"><span class="heading-text">Optional extensions</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#optional-extensions" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Now that you are familiar with the dataset, go explore other variables,
statistics, or relationships, for example:</p><ul><li><p>Plotting humidity vs. habitat type</p></li><li><p>Looking at the diurnal cycle (average daily pattern)</p></li><li><p>Comparing spatial variation between sensors</p></li></ul><h2 id="reflection-tasks" class="relative group"><span class="heading-text">Reflection Tasks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#reflection-tasks" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="id-1-descriptive-statistics-paragraph" class="relative group"><span class="heading-text">1. Descriptive statistics paragraph</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-descriptive-statistics-paragraph" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Write a short summary of:</p><ul><li><p>Your dataset (number of sensors, time range, variables measured)</p></li><li><p>Any unusual patterns or outliers</p></li><li><p>How your measurements compare with official weather station data</p></li></ul><h3 id="id-2-interpretation-of-modelling-results" class="relative group"><span class="heading-text">2. Interpretation of modelling results</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-interpretation-of-modelling-results" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In ~300 words, explain:</p><ul><li><p>What your ANOVA shows</p></li><li><p>Whether this result supports your hypothesis</p></li></ul><aside class="myst-admonition myst-admonition-important my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path fill-rule="evenodd" d="M14.615 1.595a.75.75 0 0 1 .359.852L12.982 9.75h7.268a.75.75 0 0 1 .548 1.262l-10.5 11.25a.75.75 0 0 1-1.272-.71l1.992-7.302H3.75a.75.75 0 0 1-.548-1.262l10.5-11.25a.75.75 0 0 1 .913-.143Z" clip-rule="evenodd"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Key takeaway</div></div><div class="myst-admonition-body px-4 py-1"><p>Data cleaning and exploratory analysis are not just “pre-work”, they are
essential steps in understanding your data set, spotting problems, and making
sure your conclusions are valid.</p></div></aside><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/gis-practical"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Ecological and Evolutionary Data Science</div>Spatial Methods</div></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let d=Math.random().toString(32).slice(2);window.history.replaceState({key:d},"")}try{let u=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof u=="number"&&window.scrollTo(0,u)}catch(d){console.error(d),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-UGO2RSJF.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-HHKX4TLX.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-YATQFWLS.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-MBMQ6BQC.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-CVDX4WR7.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-NK7RXO5Q.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/root-TRTRBUUN.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-6NUWI4AQ.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/_shared/chunk-M5KN76GI.js"/><link rel="modulepreload" href="https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/routes/$-VLPGWU3Z.js"/><script>window.__remixContext = {"url":"/microclimate-sensor-analysis-easylog","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.3","options":{"folders":false},"nav":[],"actions":[],"projects":[{"title":"Ecological and Evolutionary Data Science","toc":[{"file":"intro.md"},{"file":"practical_requirements.md"},{"file":"gis_practical/gis_practical.md"},{"file":"microclimate/microclimate_sensor_analysis_EasyLog.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"practical-requirements","title":"Required packages and data","short_title":"Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"gis-practical","title":"Spatial methods in Ecological and Evolutionary Data Science","short_title":"Spatial Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"microclimate-sensor-analysis-easylog","title":"Microclimate sensor data analysis in R","short_title":"Microclimate","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3101","MODE":"static","BASE_URL":"https://imperialcollegelondon.github.io/living_planet_eco_evo_data"},"routes/$":{"config":{"version":2,"myst":"1.6.3","options":{"folders":false},"nav":[],"actions":[],"projects":[{"title":"Ecological and Evolutionary Data Science","toc":[{"file":"intro.md"},{"file":"practical_requirements.md"},{"file":"gis_practical/gis_practical.md"},{"file":"microclimate/microclimate_sensor_analysis_EasyLog.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"practical-requirements","title":"Required packages and data","short_title":"Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"gis-practical","title":"Spatial methods in Ecological and Evolutionary Data Science","short_title":"Spatial Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"microclimate-sensor-analysis-easylog","title":"Microclimate sensor data analysis in R","short_title":"Microclimate","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":2,"kind":"Notebook","sha256":"7fda1031b5c363afa7beb6e260d0d8f09bc462afc048e59e8ab4c24022285e92","slug":"microclimate-sensor-analysis-easylog","location":"/microclimate/microclimate_sensor_analysis_EasyLog.md","dependencies":[],"frontmatter":{"title":"Microclimate sensor data analysis in R","short_title":"Microclimate","authors":[{"nameParsed":{"literal":"Vivienne Groner","given":"Vivienne","family":"Groner"},"name":"Vivienne Groner","id":"contributors-microclimate_sensor_analysis_EasyLog-generated-uid-0"}],"kernelspec":{"name":"ir","display_name":"R","language":"R"},"jupytext":{"formats":"md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.11.5"}},"content_includes_title":false,"exports":[{"format":"md","filename":"microclimate_sensor_analysis_EasyLog.md","url":"https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/microclimate_sensor_-3a2abd24246d89d08ef0ad5ebd3cfc8f.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"This tutorial is designed for ecologists and environmental scientists with basic R\nskills. You will learn how to analyze microclimate data collected with an EasyLog USB\ndatalogger, focusing on loading, cleaning, and exploring, environmental time series\ndata.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"mNcHNwlHMF"}],"key":"hhQqXxlLyp"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, you will be able to:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"VKYTWHBkAY"}],"key":"AySzY2mZXe"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Load and combine multiple sensor CSV files and habitat classification data from Excel files","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"gi1aU3136S"}],"key":"PVEpAArong"}],"key":"ITUcFKoa3q"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Clean your dataset and check for data quality issues","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"bzJb13OIzf"}],"key":"uNhh8qB3nS"}],"key":"NV7iPEmVyC"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Identify and flag potential outliers using different methods","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"aTwTL74TmT"}],"key":"h4PUzDLUIr"}],"key":"DIAzDAEcaa"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualize microclimate trends over time and across sites","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"pRrM2Dcyha"}],"key":"LpuCsSeQGf"}],"key":"fxfJfSEZzx"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Perform basic statistical summaries","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"wC0xtlp5T4"}],"key":"LGsxroE8de"}],"key":"VpqTBp6mXg"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Fit ANOVA to explore ecological relationships","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"lydtaRtgUL"}],"key":"r7BaYxQOZf"}],"key":"vP9zExFigt"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Export cleaned data for further analysis","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"O7WbjdzxUe"}],"key":"WAgiw4Cl18"}],"key":"SUqkSpRSFZ"}],"key":"FD8AaGfRiL"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"The skills and methods you learn here apply broadly to other environmental\ndatasets.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"XIHEwYGCs0"}],"key":"AI8jEpUtRH"},{"type":"heading","depth":2,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Load required libraries","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"W4ffEjyqwc"}],"identifier":"load-required-libraries","label":"Load required libraries","html_id":"load-required-libraries","implicit":true,"key":"uWNplPAF91"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"You will use several R packages that simplify data manipulation, date handling,\nand plotting:","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"yLQngnfYLo"}],"key":"laumMw9Uq8"}],"key":"h4KsUOpbim"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"library(openxlsx2)   # for opening excel files\nlibrary(ggplot2)\nlibrary(dplyr)\n# library(tidyverse)   # for data manipulation and plotting\nlibrary(janitor)     # for cleaning column names and general tidying\nlibrary(patchwork)   # for combining plots","visibility":"show","key":"iDqidUPTup"},{"type":"output","id":"XWvgbRRmoAWNqvo2xX9L5","data":[],"visibility":"show","key":"TpPZ8futdu"}],"data":{"tags":["remove-stderr"]},"visibility":"show","key":"jFA7DrnrIL"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Set up file paths","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"ogeToL27tC"}],"identifier":"set-up-file-paths","label":"Set up file paths","html_id":"set-up-file-paths","implicit":true,"key":"UXXUDG23vd"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"In this practical, we expect to find the sensor data and habitat classification data in\nthe directories described in the ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"vqdDYKHaya"},{"type":"link","url":"/practical-requirements","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"practical requirements","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"qBVCy0XkiB"}],"urlSource":"../practical_requirements.md","dataUrl":"/practical-requirements.json","internal":true,"protocol":"file","key":"mkh7MHXJgz"},{"type":"text","value":"\nnotes.","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"Tx5ZQ0j1lG"}],"key":"QmXSLuc8su"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"More generally, storing file paths in variables makes your code easier to update and\nmaintain. If you move your data later, you only need to change the code in one place.","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"ELQvAK1UyT"}],"key":"ZKnDjpUnMA"}],"key":"v8gwJiJ6sb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Define the full paths to the folder containing your sensor data and to the \n# metadata file \nsensor_data_folder \u003c- \"../data/Microclimate/2025\"\nsensor_metadata_file \u003c- \"../data/SensorSites/2025/sensor_sites_2025.csv\"\n\n# Get the paths to all of the CSV files containing climate data from this year. This\n# command searches all of the folders within the sensor data folder for *.txt files.\nmicroclimate_files \u003c- dir(\n  path=sensor_data_folder, pattern=\"*.txt\", \n  recursive = TRUE, full.names = TRUE\n)\n\n# Check what files we found\nprint(microclimate_files)","key":"PhMTrv4kGL"},{"type":"output","id":"K3zzhEEnwooViJ-DfAtXh","data":[{"output_type":"stream","name":"stdout","text":" [1] \"../data/Microclimate/2025/microclimate_DL_06_108_2025/DL-06 (modified).txt\"         \n [2] \"../data/Microclimate/2025/microclimate_DL_14_55_13_2025/DL-14.txt\"                  \n [3] \"../data/Microclimate/2025/microclimate_DL_15_5_63_2025/DL-15.txt\"                   \n [4] \"../data/Microclimate/2025/microclimate_DL_21_16_2025/DL-21 (modified).txt\"          \n [5] \"../data/Microclimate/2025/microclimate_DL_21_16_2025/DL-21.txt\"                     \n [6] \"../data/Microclimate/2025/microclimate_DL_25_97_2025/DL-25_97.txt\"                  \n [7] \"../data/Microclimate/2025/microclimate_DL-11_49_2025/DL-11.txt\"                     \n [8] \"../data/Microclimate/2025/microclimate_DL-12_09_60-2025/DL-12_60_2025.txt\"          \n [9] \"../data/Microclimate/2025/microclimate_DL-18_45_2025/DL-18.txt\"                     \n[10] \"../data/Microclimate/2025/microclimate_DL-20_NHM1_2025/DL-20.txt\"                   \n[11] \"../data/Microclimate/2025/microclimate_DL-26_18_2025/DL-26.txt\"                     \n[12] \"../data/Microclimate/2025/microclimate_DL-27_68_2025/microclimate_DL-27_68_2025.txt\"\n"}],"key":"ZW8MqQQ59V"}],"key":"VoiOHrxWBo"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"Read sensor data","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"pUVHcQyHoR"}],"identifier":"read-sensor-data","label":"Read sensor data","html_id":"read-sensor-data","implicit":true,"key":"Tq55HCjWUx"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"Sensor data often contain inconsistencies such as mixed date formats or data types,\nwhich can cause issues during analysis. The format of the output files from the EasyLog\nsensors is also odd - there is the serial number field that only uses the first row.\nHowever, the main data is always in the first five columns. We can use the code below to\ncompile the data across files into a single data frame.","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"efvPIBeppG"}],"key":"Z0zfLkB7iY"}],"key":"zpX1T5KV8p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Create an object name to collect combined data\nall_data \u003c- NULL\n\nfor (each_file in microclimate_files) {\n\n    # Load this file, handling Windows file encoding of characters\n    data \u003c- read.csv(each_file, encoding = \"latin1\")\n    \n    # Extract the name of the first column, which is the sensor ID\n    sensor_id \u003c- names(data)[1]\n\n    # Reduce to the first five columns and standardise the field names\n    data \u003c- subset(data, select=1:5)\n    names(data) \u003c- c(\n      \"observation_id\", \"datetime\", \"temperature\", \"humidity\", \"dewpoint\"\n    )\n    \n    # Record the sensor_id\n    data$sensor_id \u003c- sensor_id\n\n    # Add the data on to the combined data\n    all_data \u003c- rbind(all_data, data)\n}\n\n# Convert the time data and sensor id\nall_data$datetime \u003c- as.POSIXct(all_data$datetime)\nall_data$sensor_id \u003c- factor(all_data$sensor_id)","key":"XAM0NUJR2W"},{"type":"output","id":"jBx9tM85pgS9t9KdZVomf","data":[],"key":"aY23PsX2MA"}],"key":"ghyjU4Htih"},{"type":"block","children":[{"type":"admonition","kind":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"What just happened?","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"PTfWvHZiYH"}],"key":"dtXGzJLGxV"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"It is quite common to want to join a set of identical files into a single data frame.\nThe ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"pe1R3TPeIp"},{"type":"inlineCode","value":"base::rbind","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"AmAXYS4fn0"},{"type":"text","value":" function is used to combine two data frames, but how do you get this\nstarted: do you load one file first and then loop the rest? The trick is that\n","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"DRcaGGJ4jm"},{"type":"inlineCode","value":"rbind(NULL, my_data_frame)","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"RHKXPLuSY3"},{"type":"text","value":" just gives you back ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"FbYQZm71dK"},{"type":"inlineCode","value":"my_data_frame","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"J4MvSbzu7n"},{"type":"text","value":", so we can use it to\nstart the loop over all the files.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"B96LjeNqaL"}],"key":"KSpO1mvfuS"}],"key":"e3F6oEz0vp"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"We should now be able to preview the data","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"AXUfY1h5Rt"}],"key":"WISN9dGjVX"}],"key":"E4NFOE8fSU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"print(head(all_data))","key":"iAKzrLLr8f"},{"type":"output","id":"QM1SySfAdtdZF8dBU0NuH","data":[{"output_type":"stream","name":"stdout","text":"  observation_id            datetime temperature humidity dewpoint sensor_id\n1              1 2025-10-06 09:00:00        22.5       48     10.9     DL.06\n2              2 2025-10-06 09:15:00        22.5       48     10.9     DL.06\n3              3 2025-10-06 09:30:00        22.5       48     10.9     DL.06\n4              4 2025-10-06 09:45:00        22.5       48     10.9     DL.06\n5              5 2025-10-06 10:00:00        22.5       48     10.9     DL.06\n6              6 2025-10-06 10:15:00        22.5       48     10.9     DL.06\n"}],"key":"JqTS12NloJ"}],"key":"fs1VHizpLM"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"First inspection of the data","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"RakY9uS1B0"}],"identifier":"first-inspection-of-the-data","label":"First inspection of the data","html_id":"first-inspection-of-the-data","implicit":true,"key":"AoNIAZVPdB"},{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Before doing any statistics, ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"yuaSFeHWEi"},{"type":"strong","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"always look at your raw data","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"Q3hfOn79Fz"}],"key":"CwqEnZgmxr"},{"type":"text","value":". An easy way to do this is\na basic boxplot:","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"FdQf8NSmFZ"}],"key":"o43IghD4C7"}],"key":"E3dnEXgUYb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"ggplot(all_data, aes(x = sensor_id, y = temperature)) +\n  geom_boxplot() +\n  labs(\n    title = \"Temperature distribution per sensor\",\n    x = \"Sensor ID\",\n    y = \"Temperature (°C)\"\n  )","key":"ZwLfMSZdl6"},{"type":"output","id":"4nLukGV_13nsVyo40wll0","data":[{"output_type":"display_data","metadata":{"image/png":{"width":420,"height":420}},"data":{"text/plain":{"content":"plot without title","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"6e293c0815b8c4a8c15b7a82dc29f3cd","path":"https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/6e293c0815b8c4a8c15b7a82dc29f3cd.png"}}}],"key":"fjJzPm2xpf"}],"key":"fTkn46A2b2"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"If you see values far outside the main cluster, they might be outliers or errors.\nHowever, remember: ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"Ik4dDTZU1C"},{"type":"strong","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"not all extreme values are mistakes","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"DZ5ojKkxAO"}],"key":"f4J6SNZi5F"},{"type":"text","value":", a sudden heat spike could be\nreal. Always think carefully before you remove any points from your data set.","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"NtyYRNhS2C"}],"key":"CQ4O3HSjTx"},{"type":"heading","depth":3,"position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"Quick detour: Comparison to station data","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"WsvgbQsloN"}],"identifier":"quick-detour-comparison-to-station-data","label":"Quick detour: Comparison to station data","html_id":"quick-detour-comparison-to-station-data","implicit":true,"key":"Ti2jzV69fa"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"Go online to explore historic weather data:","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"kjohir9gLy"}],"key":"QNmCAtawoU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":157,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://wow.metoffice.gov.uk/","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"UK Met office WOW","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"I7PH6kIYb0"}],"urlSource":"https://wow.metoffice.gov.uk/","key":"xqLlhPwsyC"}],"key":"yRcH2F4ETO"}],"key":"hXXj6mpL5J"},{"type":"listItem","spread":true,"position":{"start":{"line":158,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://www.timeanddate.com/weather/@2656992/historic","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"Time and Date historic weather","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"emUt1E3srR"}],"urlSource":"https://www.timeanddate.com/weather/@2656992/historic","key":"OqLz8PYHvq"}],"key":"mOm84wrFGs"}],"key":"OzMkA3ang0"}],"key":"VGaEEQ6to1"},{"type":"paragraph","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"Look for temperature time series covering your measurement period. Compare:","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"Q99dokIrmp"}],"key":"HCrQp9zzXd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":162,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Are the daily patterns similar?","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"UWWRM18baR"}],"key":"twajRFvaVK"}],"key":"Cb0BI2AZc2"},{"type":"listItem","spread":true,"position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Is the temperature range realistic for the time of year?","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"KzWmLrJfIn"}],"key":"as0E3jmwpa"}],"key":"IgxQBHlljb"},{"type":"listItem","spread":true,"position":{"start":{"line":164,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Were any extreme values recorded?","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"uxilBIx8n1"}],"key":"QHlHDdMyh3"}],"key":"dTF6UpeJ7z"}],"key":"lmyjHEXHK8"},{"type":"paragraph","position":{"start":{"line":166,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"If you find differences between your data and the station observations data,\nwhat could be possible reasons?","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"Qe7MoFFsGu"}],"key":"o21a3oGTSv"},{"type":"heading","depth":2,"position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"Identifying outliers","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"CifvMdLdBd"}],"identifier":"identifying-outliers","label":"Identifying outliers","html_id":"identifying-outliers","implicit":true,"key":"mMVQYh83OB"},{"type":"paragraph","position":{"start":{"line":171,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"There are several ways to identify outliers. The table below summarizes three\ncommon methods with their pros and cons.","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"NtDzSFxwhh"}],"key":"dxSTKggOaZ"},{"type":"paragraph","position":{"start":{"line":174,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"You already did the visual inspection;\nZ-score and Interquartile Range (IQR) method are described in more detail below.","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"eADpWPgQem"}],"key":"KoF5fboTuD"},{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"Do you expect to get the same outliers with different methods?","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"c8ZNYk3fyG"}],"key":"ORTE9yFAay"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Sensor specific outliers","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"nlddcSKwI0"}],"key":"iEolsBi4NY"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"It is appropriate to calculate outliers for each sensor individually\nbecause each sensor can have its own baseline, bias, and range of variation.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"J3d0unVxXL"}],"key":"QZqAE8lDWS"}],"key":"Ka7YzrNRZJ"},{"type":"container","kind":"table","children":[{"type":"table","children":[{"type":"tableRow","children":[{"type":"tableCell","header":true,"children":[{"type":"paragraph","children":[{"type":"text","value":"Method","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"hUhofAg4xp"}],"key":"caUNdTvH4N"}],"key":"box5uSEWvY"},{"type":"tableCell","header":true,"children":[{"type":"paragraph","children":[{"type":"text","value":"How It Works","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"CUMrGYMRZF"}],"key":"WegjW6JQex"}],"key":"YuQYoQzcPa"},{"type":"tableCell","header":true,"children":[{"type":"paragraph","children":[{"type":"text","value":"Pros","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"bCstgJR0zo"}],"key":"mpWdI53QN6"}],"key":"fSNrSr4UtD"},{"type":"tableCell","header":true,"children":[{"type":"paragraph","children":[{"type":"text","value":"Cons","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"PRmi8tTWx1"}],"key":"W3UaJlU6u6"}],"key":"yD96UQWF70"}],"key":"gn1GtAB8xn"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Visual","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"Zvz9u8U260"}],"key":"QhGN8cfbNi"}],"key":"XM2Els6tnX"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Use boxplots or scatterplots to spot unusual points visually.","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"iWX0wa2T90"}],"key":"G85WIBoAza"}],"key":"EccwHMsVDP"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Quick, intuitive, and easy to spot obvious anomalies.","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"NpXvw87Jax"}],"key":"QupRjznTzL"}],"key":"fEMZGZQt7P"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Not systematic; subjective; may miss subtle outliers.","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"dSeP7OlMoL"}],"key":"bWj5EfUWwu"}],"key":"HlTA5fAC4N"}],"key":"WSUyPvVrEm"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Z-score","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"fApVzZ95s4"}],"key":"SZRrdyXYkt"}],"key":"rvD6CKcCd3"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Calculate how many standard deviations a value is from the mean.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"fndVTwfJxB"}],"key":"JxFjTwDlMX"}],"key":"yCx9lyn3N1"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Fast to compute; effective for bell-shaped (normal) data.","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"nD78C9eAD3"}],"key":"M629SKqkYT"}],"key":"RMr8VS4gNN"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Misleading for skewed data or when extreme values distort mean and SD.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"xQy4rrsNJu"}],"key":"yYKxMKHbAh"}],"key":"nGtvmEL1CO"}],"key":"EJcmdmyGsw"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Inter-quartile range (IQR)","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"IxkFIbSZRL"}],"key":"Q01BEmXwsN"}],"key":"Wil1cqPlgD"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Flags points outside 1.5×IQR below Q1 or above Q3 percentiles.","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"zwOOCXuYxF"}],"key":"hqVmJ3j4ay"}],"key":"ow5o7AhldW"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"Robust to skewed data; less influenced by extreme values.","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"RrDxFYHuyk"}],"key":"A1MDjMreIr"}],"key":"mYNV1GbFd1"},{"type":"tableCell","children":[{"type":"paragraph","children":[{"type":"text","value":"May label valid extreme values as outliers, especially with small sample sizes.","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"b0rGGgWXKI"}],"key":"Qek8rYwEZT"}],"key":"LOzEfth1P4"}],"key":"YkvOvwbTXS"}],"key":"DloeP1wbke"}],"enumerator":"1","key":"al6xaGO52J"},{"type":"heading","depth":3,"position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"Z-score method for outlier detection","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"vYTniZtG0U"}],"identifier":"z-score-method-for-outlier-detection","label":"Z-score method for outlier detection","html_id":"z-score-method-for-outlier-detection","implicit":true,"key":"QAeYwvCSZ5"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"The Z-score measures how far each value is from the mean, in units of standard\ndeviations:","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"WabYtTcnja"}],"key":"RYydI0Kq3p"},{"type":"math","value":"Z = \\frac{\\text{value} - \\text{mean}}{\\text{standard deviation}}","position":{"start":{"line":213,"column":1},"end":{"line":215,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eZ\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmtext\u003evalue\u003c/mtext\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmtext\u003emean\u003c/mtext\u003e\u003c/mrow\u003e\u003cmtext\u003estandard deviation\u003c/mtext\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eZ = \\frac{\\text{value} - \\text{mean}}{\\text{standard deviation}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\"\u003eZ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003estandard deviation\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003evalue\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003emean\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"sgEjXpH5Nu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":217,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A Z-score of 0 = exactly the mean.","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"F23IWhx32R"}],"key":"mKnjj4pi6d"}],"key":"ciPWWHwD6k"},{"type":"listItem","spread":true,"position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A Z-score of +2 = two standard deviations above the mean.","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"kQgFHF0BMY"}],"key":"b6NbAPOqpV"}],"key":"it83HJhKDr"},{"type":"listItem","spread":true,"position":{"start":{"line":219,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A Z-score of –3 = three standard deviations below the mean.","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"Mp7T91Rz44"}],"key":"Vz3EPtkaaU"}],"key":"xsmdcrPZbM"}],"key":"RsK6P4O8YR"},{"type":"paragraph","position":{"start":{"line":221,"column":1},"end":{"line":222,"column":1}},"children":[{"type":"text","value":"For normally distributed data, 99.7% of values lie within ±3 standard deviations.\nValues beyond this range are flagged as potential outliers.","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"PVTzhXFvQu"}],"key":"DDbD5bZf8G"}],"key":"rBSGK1Swaj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"all_data_Z \u003c- all_data %\u003e%\n  # Compute Z-score per sensor_id\n  group_by(sensor_id) %\u003e%\n  mutate(\n    temperature_Z = (\n      (temperature - mean(temperature, na.rm = TRUE))\n      / sd(temperature, na.rm = TRUE)\n    ),\n    temp_outlier_Z = abs(temperature_Z) \u003e 3\n  ) %\u003e%\n  ungroup()\n\n# Check what that added\nprint(head(all_data_Z))","key":"HxSUUGB1ff"},{"type":"output","id":"qHRuHFJy1-SDjgwarKzdm","data":[{"output_type":"stream","name":"stdout","text":"\u001b[90m# A tibble: 6 × 8\u001b[39m\n  observation_id datetime            temperature humidity dewpoint sensor_id\n           \u001b[3m\u001b[90m\u003cint\u003e\u001b[39m\u001b[23m \u001b[3m\u001b[90m\u003cdttm\u003e\u001b[39m\u001b[23m                    \u001b[3m\u001b[90m\u003cdbl\u003e\u001b[39m\u001b[23m    \u001b[3m\u001b[90m\u003cdbl\u003e\u001b[39m\u001b[23m    \u001b[3m\u001b[90m\u003cdbl\u003e\u001b[39m\u001b[23m \u001b[3m\u001b[90m\u003cfct\u003e\u001b[39m\u001b[23m    \n\u001b[90m1\u001b[39m              1 2025-10-06 \u001b[90m09:00:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m2\u001b[39m              2 2025-10-06 \u001b[90m09:15:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m3\u001b[39m              3 2025-10-06 \u001b[90m09:30:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m4\u001b[39m              4 2025-10-06 \u001b[90m09:45:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m5\u001b[39m              5 2025-10-06 \u001b[90m10:00:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m6\u001b[39m              6 2025-10-06 \u001b[90m10:15:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m# ℹ 2 more variables: temperature_Z \u003cdbl\u003e, temp_outlier_Z \u003clgl\u003e\u001b[39m\n"}],"key":"aSkuhLPbKo"}],"key":"UCqYZ4aJhn"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"Interquartile Range (IQR) Method for Outlier Detection","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"K4cJ2KEZ5b"}],"identifier":"interquartile-range-iqr-method-for-outlier-detection","label":"Interquartile Range (IQR) Method for Outlier Detection","html_id":"interquartile-range-iqr-method-for-outlier-detection","implicit":true,"key":"ZPRu2ShUEC"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"The IQR method focuses on the spread of the middle 50% of the data.\nIt calculates the difference between the 75th percentile (Q3) and the\n5th percentile (Q1), called the interquartile range (IQR). Values falling below\n( Q1 - 1.5 \\times IQR ) or above ( Q3 + 1.5 \\times IQR ) are considered\npotential outliers.","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"bKtcXu51s2"}],"key":"SXfR3dlB8M"}],"key":"MmTp5kqh55"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Use the IQR method to flag temperature outliers per sensor\nall_data_IQR \u003c- all_data %\u003e%\n  group_by(sensor_id) %\u003e%\n  mutate(\n    # Temperature IQR\n    temp_Q1 = quantile(temperature, 0.25, na.rm = TRUE),\n    temp_Q3 = quantile(temperature, 0.75, na.rm = TRUE),\n    temp_IQR = temp_Q3 - temp_Q1,\n    temp_outlier_IQR = if_else(\n      temperature \u003c (temp_Q1 - 1.5 * temp_IQR) | temperature \u003e (temp_Q3 + 1.5 * temp_IQR),\n      TRUE, FALSE, missing = FALSE\n    ),\n  ) %\u003e%\n  ungroup()\n\n# Check what that added\nprint(head(all_data_IQR))","key":"WBjjnpR5Ks"},{"type":"output","id":"Geh4cJ_X1guMSuKGPeiZM","data":[{"output_type":"stream","name":"stdout","text":"\u001b[90m# A tibble: 6 × 10\u001b[39m\n  observation_id datetime            temperature humidity dewpoint sensor_id\n           \u001b[3m\u001b[90m\u003cint\u003e\u001b[39m\u001b[23m \u001b[3m\u001b[90m\u003cdttm\u003e\u001b[39m\u001b[23m                    \u001b[3m\u001b[90m\u003cdbl\u003e\u001b[39m\u001b[23m    \u001b[3m\u001b[90m\u003cdbl\u003e\u001b[39m\u001b[23m    \u001b[3m\u001b[90m\u003cdbl\u003e\u001b[39m\u001b[23m \u001b[3m\u001b[90m\u003cfct\u003e\u001b[39m\u001b[23m    \n\u001b[90m1\u001b[39m              1 2025-10-06 \u001b[90m09:00:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m2\u001b[39m              2 2025-10-06 \u001b[90m09:15:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m3\u001b[39m              3 2025-10-06 \u001b[90m09:30:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m4\u001b[39m              4 2025-10-06 \u001b[90m09:45:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m5\u001b[39m              5 2025-10-06 \u001b[90m10:00:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m6\u001b[39m              6 2025-10-06 \u001b[90m10:15:00\u001b[39m        22.5       48     10.9 DL.06    \n\u001b[90m# ℹ 4 more variables: temp_Q1 \u003cdbl\u003e, temp_Q3 \u003cdbl\u003e, temp_IQR \u003cdbl\u003e,\u001b[39m\n\u001b[90m#   temp_outlier_IQR \u003clgl\u003e\u001b[39m\n"}],"key":"d91zVqkAxR"}],"key":"HO55apDU2Z"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"Visualize temperature over time with outliers highlighted","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"HAp7FtYyfH"}],"identifier":"visualize-temperature-over-time-with-outliers-highlighted","label":"Visualize temperature over time with outliers highlighted","html_id":"visualize-temperature-over-time-with-outliers-highlighted","implicit":true,"key":"EhkHzi8let"}],"key":"cs36RhFBSM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"options(repr.plot.width=12, repr.plot.height=10)","visibility":"show","key":"l6mjazgbDn"},{"type":"output","id":"4C5_y8jFBogiE23zM6WYu","data":[],"visibility":"show","key":"XVag4HvV3p"}],"data":{"tags":[]},"visibility":"remove","key":"t4JYdYI3MC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Plot using IQR outlier flags\np1 \u003c- ggplot(\n  all_data_IQR,\n  aes(x = datetime, y = temperature, color = temp_outlier_IQR, group = sensor_id)\n) +\n  geom_point() +\n  geom_line() +\n  facet_wrap(~sensor_id) +\n  scale_color_manual(values = c(\"black\", \"red\")) +\n  labs(\n    title = \"Temperature over Time (IQR Outliers)\",\n    x = \"Datetime\",\n    y = \"Temperature (°C)\",\n    color = \"Outlier\"\n  ) +\n  theme_minimal()\n\n# Plot using Z-score outlier flags\np2 \u003c- ggplot(\n  all_data_Z,\n  aes(x = datetime, y = temperature, color = temp_outlier_Z, group = sensor_id)\n) +\n  geom_point() +\n  geom_line() +\n  facet_wrap(~sensor_id) +\n  scale_color_manual(values = c(\"black\", \"blue\")) +\n  labs(\n    title = \"Temperature over Time (Z-score Outliers)\",\n    x = \"Datetime\",\n    y = \"Temperature (°C)\",\n    color = \"Outlier\"\n  ) +\n  theme_minimal()\n\n# Combine plots side-by-side\np1 + p2 + plot_layout(ncol = 1)","key":"eABzwBqVWE"},{"type":"output","id":"3aiTCCk1uZoiHH0Nrs9TE","data":[{"output_type":"display_data","metadata":{"image/png":{"width":720,"height":600}},"data":{"text/plain":{"content":"plot without title","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d5863379748047daafa7f9a8dd9534eb","path":"https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/d5863379748047daafa7f9a8dd9534eb.png"}}}],"key":"hgCpVLOd8I"}],"key":"QPBvuSa6gt"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"Read and add sensor location","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"ectmM1Vmii"}],"identifier":"read-and-add-sensor-location","label":"Read and add sensor location","html_id":"read-and-add-sensor-location","implicit":true,"key":"VsAbsScz8x"},{"type":"paragraph","position":{"start":{"line":318,"column":1},"end":{"line":322,"column":1}},"children":[{"type":"text","value":"You will have recorded metadata such as habitat type, location coordinates, or\nnotes about the sensor placement during your field experiment in an Excel\nspreadsheet. The rest of the module will add extra data on the differences between the\nsensor location sites, but for now we can simply look to see if there are any\ndifferences between the NHM and Silwood by using the longitude of the locations.","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"g1MGy8tRMp"}],"key":"d9GBIyrn8C"}],"key":"o1t9LyOdWw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Read meta data\nmetadata \u003c- read.csv(sensor_metadata_file)\n\n# Get the site location using longitude\nmetadata$site \u003c- ifelse(metadata$long_Sensor_location \u003e -0.5, \"NHM\", \"Silwood\")\n\n# Drop down to two required fields and change Sensor ID from DL-xxx to DL.xxx to match \n# EpiCollect 5 metadata file\nhabitat_classification \u003c- metadata[,c(\"Logger_SerialNumber\", \"site\")]\nnames(habitat_classification) \u003c- c(\"sensor_id\", \"site\")\nhabitat_classification$sensor_id \u003c- sub(\"-\", \".\", habitat_classification$sensor_id)","key":"Ftavfp4wjT"},{"type":"output","id":"eBvUYGtIIwLHnaA1WWHMq","data":[],"key":"cVHOpERTyX"}],"key":"wZFHThgtpg"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"Summarize maximum temperature per sensor","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"iT24ilACmP"}],"identifier":"summarize-maximum-temperature-per-sensor","label":"Summarize maximum temperature per sensor","html_id":"summarize-maximum-temperature-per-sensor","implicit":true,"key":"QSxVIvl0GQ"},{"type":"paragraph","position":{"start":{"line":340,"column":1},"end":{"line":341,"column":1}},"children":[{"type":"text","value":"The following analysis focuses on the IQR data set; try the same\nsteps with the Z-score or other alternative methods in your own time.","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"OZFK2p9Rkn"}],"key":"CTMxCL2A7d"}],"key":"Af6HsBWcZi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Remove outliers and NAs before summarising\nsummary_data \u003c- all_data_IQR %\u003e%\n  filter(!temp_outlier_IQR, !is.na(temperature)) %\u003e%\n  group_by(sensor_id) %\u003e%\n  summarize(max_temperature = max(temperature), .groups = \"drop\") %\u003e%\n  left_join(habitat_classification, by = \"sensor_id\") # add metadata\n\n# Display summary table\nprint(summary_data)","key":"L4AeurbWQ9"},{"type":"output","id":"iU8Oubruf2bBrMMbquDLC","data":[{"output_type":"stream","name":"stdout","text":"\u001b[90m# A tibble: 11 × 3\u001b[39m\n   sensor_id max_temperature site   \n   \u001b[3m\u001b[90m\u003cchr\u003e\u001b[39m\u001b[23m               \u001b[3m\u001b[90m\u003cdbl\u003e\u001b[39m\u001b[23m \u001b[3m\u001b[90m\u003cchr\u003e\u001b[39m\u001b[23m  \n\u001b[90m 1\u001b[39m DL.06                18.5 Silwood\n\u001b[90m 2\u001b[39m DL.11                21   Silwood\n\u001b[90m 3\u001b[39m DL.12                23   Silwood\n\u001b[90m 4\u001b[39m DL.14                19.5 Silwood\n\u001b[90m 5\u001b[39m DL.15                18   Silwood\n\u001b[90m 6\u001b[39m DL.18                20.5 Silwood\n\u001b[90m 7\u001b[39m DL.20                20.5 NHM    \n\u001b[90m 8\u001b[39m DL.21                20   Silwood\n\u001b[90m 9\u001b[39m DL.25                20.5 Silwood\n\u001b[90m10\u001b[39m DL.26                20   Silwood\n\u001b[90m11\u001b[39m DL.27                20.5 \u001b[31mNA\u001b[39m     \n"}],"key":"CPVZ7HuhNz"}],"key":"zzbHP3q5BK"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"children":[{"type":"text","value":"Fit ANOVA: max temperature ~ location","position":{"start":{"line":355,"column":1},"end":{"line":355,"column":1}},"key":"ePwdvANgSa"}],"identifier":"fit-anova-max-temperature-location","label":"Fit ANOVA: max temperature ~ location","html_id":"fit-anova-max-temperature-location","implicit":true,"key":"Kcau2uUntO"},{"type":"paragraph","position":{"start":{"line":357,"column":1},"end":{"line":358,"column":1}},"children":[{"type":"text","value":"ANOVA (Analysis of Variance) is a statistical method used to test whether the\nmeans of a continuous variable differ significantly across two or more groups.","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"LFvElnJ7Ny"}],"key":"xjUDuo1rvE"},{"type":"paragraph","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"children":[{"type":"text","value":"Test whether the max temperature is predicted by location. What do you expect?","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"a2OxrZIijf"}],"key":"y2mk3LwqDi"}],"key":"yZMr7PG9vh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"# Fit ANOVA\nanova_model \u003c- lm(max_temperature ~ site, data = summary_data)\nsummary(anova_model) # View ANOVA table","key":"g5G2mfcBQW"},{"type":"output","id":"vgbxPKkhaErkMYzbRLNBa","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\nCall:\nlm(formula = max_temperature ~ site, data = summary_data)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.11111 -0.48611 -0.05556  0.38889  2.88889 \n\nCoefficients:\n            Estimate Std. Error t value Pr(\u003e|t|)    \n(Intercept)  20.5000     1.4530  14.109 6.19e-07 ***\nsiteSilwood  -0.3889     1.5316  -0.254    0.806    \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 1.453 on 8 degrees of freedom\n  (1 observation deleted due to missingness)\nMultiple R-squared:  0.007995,\tAdjusted R-squared:  -0.116 \nF-statistic: 0.06447 on 1 and 8 DF,  p-value: 0.806\n","content_type":"text/plain"}}}],"key":"zmB4kqruZ7"}],"key":"PYAbGPcdId"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"Boxplot maximum temperature - habitat type relationship","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"tJV6QgEDW2"}],"identifier":"boxplot-maximum-temperature-habitat-type-relationship","label":"Boxplot maximum temperature - habitat type relationship","html_id":"boxplot-maximum-temperature-habitat-type-relationship","implicit":true,"key":"TNFjR9UHRT"}],"key":"UnhSeFIzw0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"ggplot(summary_data, aes(x = site, y = max_temperature)) +\n  geom_boxplot(fill = \"lightblue\", alpha = 0.6) +\n  geom_jitter(width = 0.1, size = 2, alpha = 0.7) +\n  labs(\n    title = \"Maximum Temperature by Habitat Type\",\n    x = \"Habitat Type\",\n    y = \"Max Temperature (°C)\"\n  ) +\n  theme_minimal()","key":"vNZDjj1NWu"},{"type":"output","id":"jTkeJ_OeG8Y9Qtcl6RrLx","data":[{"output_type":"display_data","metadata":{"image/png":{"width":720,"height":600}},"data":{"text/plain":{"content":"plot without title","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5b2a88da39983634c7db390b230409a5","path":"https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/5b2a88da39983634c7db390b230409a5.png"}}}],"key":"TFbwei4XgO"}],"key":"F7d07YLbaT"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"children":[{"type":"text","value":"Export new data set","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"key":"we6j960qbv"}],"identifier":"export-new-data-set","label":"Export new data set","html_id":"export-new-data-set","implicit":true,"key":"nqRM35V8Kc"},{"type":"paragraph","position":{"start":{"line":384,"column":1},"end":{"line":385,"column":1}},"children":[{"type":"text","value":"This is a good moment to export the combined data set from all sensors, including\ninformation on IQR and outliers.","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"hUvMf5PJVl"}],"key":"veiYxW4zhR"}],"key":"nv0YW0Ww5n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"r","executable":true,"value":"write.csv(all_data_IQR, file.path(sensor_data_folder, \"all_sensor_data_2025.csv\"))","key":"D4ADpR4eZJ"},{"type":"output","id":"qMG_Kr7f4VJZ1RZ-jZt9K","data":[],"key":"pRpONL0Svi"}],"key":"KkWGjHV4AE"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"children":[{"type":"text","value":"Optional extensions","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"JDLsPezoOS"}],"identifier":"optional-extensions","label":"Optional extensions","html_id":"optional-extensions","implicit":true,"key":"cDrV2lle7O"},{"type":"paragraph","position":{"start":{"line":394,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"Now that you are familiar with the dataset, go explore other variables,\nstatistics, or relationships, for example:","position":{"start":{"line":394,"column":1},"end":{"line":394,"column":1}},"key":"OUciNiZn95"}],"key":"Gdmycw6mgl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":397,"column":1},"end":{"line":400,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plotting humidity vs. habitat type","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"JyoFTMMrRr"}],"key":"NnzFD6WOIS"}],"key":"Jkkuvf0x7w"},{"type":"listItem","spread":true,"position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Looking at the diurnal cycle (average daily pattern)","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"pk4VbtA2Pu"}],"key":"aRN8RszDRC"}],"key":"Yv9DNoZDG1"},{"type":"listItem","spread":true,"position":{"start":{"line":399,"column":1},"end":{"line":400,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comparing spatial variation between sensors","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"vDJvbnsgAK"}],"key":"gDYed8iKP0"}],"key":"Fge00dbvcO"}],"key":"aU1kP1yxLM"},{"type":"heading","depth":2,"position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"Reflection Tasks","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"xp18RdrQPD"}],"identifier":"reflection-tasks","label":"Reflection Tasks","html_id":"reflection-tasks","implicit":true,"key":"qBZMPbtd6W"},{"type":"heading","depth":3,"position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"1. Descriptive statistics paragraph","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"HtM8rLdxoh"}],"identifier":"id-1-descriptive-statistics-paragraph","label":"1. Descriptive statistics paragraph","html_id":"id-1-descriptive-statistics-paragraph","implicit":true,"key":"r8PeoaQQLN"},{"type":"paragraph","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"children":[{"type":"text","value":"Write a short summary of:","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"sTUZ4gE45s"}],"key":"FDYDgMF1zp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":407,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Your dataset (number of sensors, time range, variables measured)","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"kWFkOKodka"}],"key":"XYS2S8eEDo"}],"key":"YtAWuVrq57"},{"type":"listItem","spread":true,"position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Any unusual patterns or outliers","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"key":"CwQNZHk9vH"}],"key":"j8AUiGokBN"}],"key":"NSd04X3CkE"},{"type":"listItem","spread":true,"position":{"start":{"line":409,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How your measurements compare with official weather station data","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"ETUx4j84B3"}],"key":"IcMrVzn3LW"}],"key":"t3Xuy8PnIY"}],"key":"HmkVJtGVtV"},{"type":"heading","depth":3,"position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"text","value":"2. Interpretation of modelling results","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"key":"Z8lzh7622A"}],"identifier":"id-2-interpretation-of-modelling-results","label":"2. Interpretation of modelling results","html_id":"id-2-interpretation-of-modelling-results","implicit":true,"key":"x5Kn0Ib7bT"},{"type":"paragraph","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"text","value":"In ~300 words, explain:","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"MiX2QY3TC2"}],"key":"yPAdMTISEQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":415,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"What your ANOVA shows","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"f2NkQDPxeX"}],"key":"Vd6lg4cy7H"}],"key":"IskIwjGBxe"},{"type":"listItem","spread":true,"position":{"start":{"line":416,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Whether this result supports your hypothesis","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"yftW6SDNwo"}],"key":"c6ymK4Ulsx"}],"key":"fXD7PmAaDL"}],"key":"TkdZEBIai5"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Key takeaway","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"NHtofPpnFF"}],"key":"Lpdxyvju8S"},{"type":"paragraph","position":{"start":{"line":420,"column":1},"end":{"line":422,"column":1}},"children":[{"type":"text","value":"Data cleaning and exploratory analysis are not just “pre-work”, they are\nessential steps in understanding your data set, spotting problems, and making\nsure your conclusions are valid.","position":{"start":{"line":420,"column":1},"end":{"line":420,"column":1}},"key":"NCvefTkavx"}],"key":"sddPRK57Jr"}],"key":"HAgeoqVoEm"}],"key":"w0qrssBR19"}],"key":"RHecx0ZWM5"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Spatial methods in Ecological and Evolutionary Data Science","short_title":"Spatial Methods","url":"/gis-practical","group":"Ecological and Evolutionary Data Science"}}},"domain":"http://localhost:3001"},"project":{"title":"Ecological and Evolutionary Data Science","toc":[{"file":"intro.md"},{"file":"practical_requirements.md"},{"file":"gis_practical/gis_practical.md"},{"file":"microclimate/microclimate_sensor_analysis_EasyLog.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"practical-requirements","title":"Required packages and data","short_title":"Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"gis-practical","title":"Spatial methods in Ecological and Evolutionary Data Science","short_title":"Spatial Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"microclimate-sensor-analysis-easylog","title":"Microclimate sensor data analysis in R","short_title":"Microclimate","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/manifest-51D9907C.js";
import * as route0 from "https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/root-TRTRBUUN.js";
import * as route1 from "https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/routes/$-VLPGWU3Z.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("https://imperialcollegelondon.github.io/living_planet_eco_evo_data/build/entry.client-PCJPW7TK.js");</script></body></html>